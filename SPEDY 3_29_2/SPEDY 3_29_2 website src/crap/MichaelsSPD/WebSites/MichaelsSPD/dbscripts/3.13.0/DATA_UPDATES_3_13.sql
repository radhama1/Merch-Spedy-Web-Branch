

--*****************************
--SPD_Report: Import Item Chemical Inventory report
--*****************************
Update SPD_Report
set Report_SQL = 
'declare @dateNow datetime    declare @dateNowStr varchar(20)    declare @month varchar(2), @day varchar(2), @year varchar(4)        set @dateNow = getdate()    set @month = convert(varchar(2), Month(@dateNow))      if (len(@month) < 2)       set @month = ''0'' + @month      set @day = convert(varchar(2), Day(@dateNow))    if (len(@day) < 2)       set @day = ''0'' + @day      set @year = convert(varchar(4), Year(@dateNow))    if (len(@year) < 4)       set @year = ''00'' + @year      set @dateNowStr =  @year + @month + @day      select     ii.ID        ,ii.Batch_ID        ,ii.DateCreated        ,ii.DateLastModified        ,ii.CreatedUserID        ,ii.UpdateUserID        ,ii.DateSubmitted        ,ii.Vendor        ,ii.Agent As MerchBurden        ,ii.AgentType As MerchBurdenType        ,ii.Buyer        ,ii.Fax        ,ii.EnteredBy        ,ii.QuoteSheetStatus        ,ii.Season        ,ii.SKUGroup        ,ii.Email        ,ii.EnteredDate        ,ii.Dept        ,ii.Class        ,ii.SubClass        ,ii.PrimaryUPC        ,ii.MichaelsSKU as SKU        ,ii.GenerateMichaelsUPC as GenerateUPC       ,ii.AdditionalUPC1        ,ii.AdditionalUPC2        ,ii.AdditionalUPC3        ,ii.AdditionalUPC4        ,ii.AdditionalUPC5        ,ii.AdditionalUPC6        ,ii.AdditionalUPC7        ,ii.AdditionalUPC8        ,ii.PackSKU        ,ii.PlanogramName        ,ii.VendorNumber        ,ii.VendorRank        ,ii.ItemTask        ,ii.Description        ,ii.PaymentTerms        ,ii.Days        ,ii.VendorMinOrderAmount        ,ii.VendorName        ,ii.VendorAddress1        ,ii.VendorAddress2        ,ii.VendorAddress3        ,ii.VendorAddress4        ,ii.VendorContactName        ,ii.VendorContactPhone        ,ii.VendorContactEmail        ,ii.VendorContactFax        ,ii.ManufactureName        ,ii.ManufactureAddress1        ,ii.ManufactureAddress2        ,ii.ManufactureContact        ,ii.ManufacturePhone        ,ii.ManufactureEmail        ,ii.ManufactureFax        ,ii.AgentContact        ,ii.AgentPhone        ,ii.AgentEmail        ,ii.AgentFax        ,ii.VendorStyleNumber        ,ii.HarmonizedCodeNumber, ii.CanadaHarmonizedCodeNumber        ,ii.DetailInvoiceCustomsDesc        ,ii.ComponentMaterialBreakdown        ,ii.ComponentConstructionMethod        ,ii.IndividualItemPackaging        ,ii.EachInsideMasterCaseBox        ,ii.EachInsideInnerPack        ,ii.ReshippableInnerCartonWeight        ,ii.ReshippableInnerCartonLength        ,ii.ReshippableInnerCartonWidth        ,ii.ReshippableInnerCartonHeight        ,ii.MasterCartonDimensionsLength        ,ii.MasterCartonDimensionsWidth        ,ii.MasterCartonDimensionsHeight        ,ii.CubicFeetPerMasterCarton        ,ii.WeightMasterCarton        ,ii.CubicFeetPerInnerCarton        ,ii.FOBShippingPoint        ,ii.DutyPercent        ,ii.DutyAmount        ,ii.AdditionalDutyComment        ,ii.AdditionalDutyAmount        ,ii.OceanFreightAmount        ,ii.OceanFreightComputedAmount        ,ii.AgentCommissionPercent As MerchBurdenPercent        ,ii.AgentCommissionAmount As MerchBurdenAmount        ,ii.OtherImportCostsPercent        ,ii.OtherImportCostsAmount        ,ii.PackagingCostAmount        ,ii.TotalImportBurden        ,ii.WarehouseLandedCost        ,ii.PurchaseOrderIssuedTo        ,ii.ShippingPoint        ,ii.CountryOfOrigin        ,ii.CountryOfOriginName        ,ii.VendorComments        ,ii.StockCategory        ,ii.FreightTerms        ,ii.ItemType        ,ii.PackItemIndicator        ,ii.ItemTypeAttribute        ,ii.AllowStoreOrder        ,ii.InventoryControl        ,ii.AutoReplenish        ,ii.PrePriced        ,ii.TaxUDA        ,ii.PrePricedUDA        ,ii.TaxValueUDA        ,ii.Stocking_Strategy_Code       ,ii.StoreSuppZoneGRP        ,ii.WhseSuppZoneGRP        ,ii.POGMaxQty        ,ii.POGSetupPerStore as Initial_Set_Qty_Per_Store    ,ii.OutboundFreight        ,ii.NinePercentWhseCharge        ,ii.TotalStoreLandedCost        ,ii.RDBase as Base1_Retail        ,ii.RDCentral as Base2_Retail        ,ii.RDTest as Test_Retail        ,ii.RDAlaska as Alaska_Retail        ,ii.RDCanada as Canada_Retail        ,ii.RD0Thru9 as High2_Retail        ,ii.RDCalifornia as High3_Retail        ,ii.RDVillageCraft as Small_Market_Retail     ,ii.Retail9 as High1_Retail        ,ii.Retail10 as Base3_Retail        ,ii.Retail11 as Low1_Retail        ,ii.Retail12 as Low2_Retail        ,ii.Retail13 as Manhattan_Retail        ,ii.HazMatYes        ,ii.HazMatNo        ,ii.HazMatMFGCountry        ,ii.HazMatMFGName        ,ii.HazMatMFGFlammable        ,ii.HazMatMFGCity        ,ii.HazMatContainerType        ,ii.HazMatMFGState        ,ii.HazMatContainerSize        ,ii.HazMatMFGPhone        ,ii.HazMatMSDSUOM        ,ii.TSSA        ,ii.CSA        ,ii.UL        ,ii.LicenceAgreement        ,ii.FumigationCertificate        ,ii.KILNDriedCertificate        ,ii.ChinaComInspecNumAndCCIBStickers        ,ii.OriginalVisa        ,ii.TextileDeclarationMidCode        ,ii.QuotaChargeStatement        ,ii.MSDS        ,ii.TSCA        ,ii.DropBallTestCert        ,ii.ManMedicalDeviceListing        ,ii.ManFDARegistration        ,ii.CopyRightIndemnification        ,ii.FishWildLifeCert        ,ii.Proposition65LabelReq        ,ii.CCCR        ,ii.FormaldehydeCompliant        ,ii.Is_Valid        ,ii.Tax_Wizard        ,ii.RMS_Sellable        ,ii.RMS_Orderable        ,ii.RMS_Inventory        ,ii.Parent_ID        ,ii.RegularBatchItem        ,ii.Sequence        ,ii.Store_Total        ,ii.POG_Start_Date        ,ii.POG_Comp_Date        ,ii.Like_Item_SKU        ,ii.Like_Item_Description        ,ii.Like_Item_Retail        ,ii.Like_Item_Regular_Unit        ,ii.Like_Item_Sales        ,ii.Facings        ,ii.POG_Min_Qty        ,ii.Displayer_Cost        ,ii.Product_Cost        ,ii.Calculate_Options        ,ii.Like_Item_Store_Count        ,ii.Like_Item_Unit_Store_Month        ,ii.Annual_Reg_Retail_Sales        ,ii.Annual_Regular_Unit_Forecast        ,ii.Inner_Pack        ,ii.Min_Pres_Per_Facing,    b.Date_Modified as Last_Modified,      case      when isnull(f1.[File_ID], 0) > 0 then ''<a href="getimage.aspx?id='' + convert(varchar(20), f1.[File_ID]) + ''" target="_blank">Image</a>''      else ''''    end as Item_Image,      case      when isnull(f2.[File_ID], 0) > 0 then ''<a href="getfile.aspx?ad=1&id='' + convert(varchar(20), f2.[File_ID]) + ''&filename=importitem_'' + convert(varchar(20), b.ID) + ''_'' + @dateNowStr + ''.pdf">MSDS Sheet</a>''      else ''''    end as MSDS_Sheet    from [SPD_Import_Items] ii       inner join [SPD_Batch] b on ii.Batch_ID = b.ID      left outer join SPD_Workflow_Stage ws on b.Workflow_Stage_ID = ws.id and ws.Workflow_id = 1      LEFT OUTER JOIN [SPD_Items_Files] f1 ON f1.Item_Type = ''I'' and f1.Item_ID = ii.[ID] and f1.File_Type = ''IMG''       LEFT OUTER JOIN [SPD_Items_Files] f2 ON f2.Item_Type = ''I'' and f2.Item_ID = ii.[ID] and f2.File_Type = ''MSDS''     where     b.enabled = 1 and       (isnull(ii.HazMatYes, '''') != '''') and       (@startDate is null or (@startDate is not null and b.date_modified >= @startDate)) and    (@endDate is null or (@endDate is not null and b.date_modified <= @endDate)) and       (isnull(@dept, 0) = 0 or (isnull(@dept, 0) > 0 and b.Fineline_Dept_ID = @dept)) and    ( (isnull(@stage, 0) = 0 and COALESCE(ws.Workflow_id, 1) = 1 and COALESCE(ws.Stage_Type_id, 1) <> 4 ) or (isnull(@stage, 0) > 0 and b.Workflow_Stage_ID = @stage)) and    ((isnull(@vendor, 0) <= 0) or (isnull(@vendor,0) > 0 and b.Vendor_Number = @vendor))  '
where rtrim(report_name) = 'Import Item Chemical Inventory';


--*****************************
--SPD_Report: Import Item Language report
--*****************************
Update SPD_Report
set Report_SQL = 
'declare @dateNow datetime      declare @dateNowStr varchar(20)      declare @month varchar(2), @day varchar(2), @year varchar(4)          set @dateNow = getdate()      set @month = convert(varchar(2), Month(@dateNow))      if (len(@month) < 2)          set @month = ''0'' + @month          set @day = convert(varchar(2), Day(@dateNow))      if (len(@day) < 2)          set @day = ''0'' + @day          set @year = convert(varchar(4), Year(@dateNow))      if (len(@year) < 4)          set @year = ''00'' + @year           set @dateNowStr =  @year + @month + @day        select     ii.ID        ,ii.Batch_ID        ,ii.DateCreated        ,ii.DateLastModified        ,ii.CreatedUserID        ,ii.UpdateUserID          ,ii.DateSubmitted        ,ii.Vendor        ,ii.Agent As MerchBurden        ,ii.AgentType As MerchBurdenType        ,ii.Buyer        ,ii.Fax        ,ii.EnteredBy        ,ii.QuoteSheetStatus          ,ii.Season        ,ii.SKUGroup        ,ii.Email        ,ii.EnteredDate        ,ii.Dept        ,ii.Class        ,ii.SubClass        ,ii.PrimaryUPC          ,ii.MichaelsSKU as SKU       ,ii.GenerateMichaelsUPC as GenerateUPC   ,ii.AdditionalUPC1        ,ii.AdditionalUPC2        ,ii.AdditionalUPC3        ,ii.AdditionalUPC4          ,ii.AdditionalUPC5        ,ii.AdditionalUPC6        ,ii.AdditionalUPC7        ,ii.AdditionalUPC8        ,ii.PackSKU        ,ii.PlanogramName          ,ii.VendorNumber        ,ii.VendorRank        ,ii.ItemTask        ,ii.Description        ,ii.PaymentTerms        ,ii.Days        ,ii.VendorMinOrderAmount          ,ii.VendorName        ,ii.VendorAddress1        ,ii.VendorAddress2        ,ii.VendorAddress3        ,ii.VendorAddress4        ,ii.VendorContactName          ,ii.VendorContactPhone        ,ii.VendorContactEmail        ,ii.VendorContactFax        ,ii.ManufactureName        ,ii.ManufactureAddress1          ,ii.ManufactureAddress2        ,ii.ManufactureContact        ,ii.ManufacturePhone        ,ii.ManufactureEmail        ,ii.ManufactureFax          ,ii.AgentContact        ,ii.AgentPhone        ,ii.AgentEmail        ,ii.AgentFax        ,ii.VendorStyleNumber        ,ii.HarmonizedCodeNumber, ii.CanadaHarmonizedCodeNumber           ,ii.DetailInvoiceCustomsDesc        ,ii.ComponentMaterialBreakdown        ,ii.ComponentConstructionMethod        ,ii.IndividualItemPackaging          ,ii.EachInsideMasterCaseBox        ,ii.EachInsideInnerPack        ,ii.ReshippableInnerCartonWeight        ,ii.ReshippableInnerCartonLength          ,ii.ReshippableInnerCartonWidth        ,ii.ReshippableInnerCartonHeight        ,ii.MasterCartonDimensionsLength        ,ii.MasterCartonDimensionsWidth          ,ii.MasterCartonDimensionsHeight        ,ii.CubicFeetPerMasterCarton        ,ii.WeightMasterCarton        ,ii.CubicFeetPerInnerCarton        ,ii.FOBShippingPoint          ,ii.DutyPercent        ,ii.DutyAmount        ,ii.AdditionalDutyComment        ,ii.AdditionalDutyAmount        ,ii.OceanFreightAmount        ,ii.OceanFreightComputedAmount          ,ii.AgentCommissionPercent As MerchBurdenPercent        ,ii.AgentCommissionAmount As MerchBurdenAmount        ,ii.OtherImportCostsPercent        ,ii.OtherImportCostsAmount        ,ii.PackagingCostAmount          ,ii.TotalImportBurden        ,ii.WarehouseLandedCost        ,ii.PurchaseOrderIssuedTo        ,ii.ShippingPoint        ,ii.CountryOfOrigin          ,ii.CountryOfOriginName        ,ii.VendorComments        ,ii.StockCategory        ,ii.FreightTerms        ,ii.ItemType        ,ii.PackItemIndicator          ,ii.ItemTypeAttribute        ,ii.AllowStoreOrder        ,ii.InventoryControl        ,ii.AutoReplenish        ,ii.PrePriced        ,ii.TaxUDA          ,ii.PrePricedUDA        ,ii.TaxValueUDA        ,ii.Stocking_Strategy_Code      ,ii.StoreSuppZoneGRP          ,ii.WhseSuppZoneGRP        ,ii.POGMaxQty        ,ii.POGSetupPerStore as Initial_Set_Qty_Per_Store        ,ii.OutboundFreight        ,ii.NinePercentWhseCharge          ,ii.TotalStoreLandedCost        ,ii.RDBase as Base1_Retail        ,ii.RDCentral as Base2_Retail        ,ii.RDTest as Test_Retail        ,ii.RDAlaska as Alaska_Retail          ,ii.RDCanada as Canada_Retail        ,ii.RD0Thru9 as High2_Retail        ,ii.RDCalifornia as High3_Retail        ,ii.RDVillageCraft as Small_Market_Retail       ,ii.Retail9 as High1_Retail        ,ii.Retail10 as Base3_Retail        ,ii.Retail11 as Low1_Retail        ,ii.Retail12 as Low2_Retail          ,ii.Retail13 as Manhattan_Retail        ,ii.RDQuebec as Q5_Retail, ii.RDPuertoRico as PR_Retail ,ii.HazMatYes        ,ii.HazMatNo          ,ii.HazMatMFGCountry        ,ii.HazMatMFGName        ,ii.HazMatMFGFlammable        ,ii.HazMatMFGCity        ,ii.HazMatContainerType        ,ii.HazMatMFGState          ,ii.HazMatContainerSize        ,ii.HazMatMFGPhone        ,ii.HazMatMSDSUOM        ,ii.TSSA        ,ii.CSA        ,ii.UL        ,ii.LicenceAgreement          ,ii.FumigationCertificate        ,ii.KILNDriedCertificate        ,ii.ChinaComInspecNumAndCCIBStickers        ,ii.OriginalVisa        ,ii.TextileDeclarationMidCode          ,ii.QuotaChargeStatement        ,ii.MSDS        ,ii.TSCA        ,ii.DropBallTestCert        ,ii.ManMedicalDeviceListing        ,ii.ManFDARegistration          ,ii.CopyRightIndemnification        ,ii.FishWildLifeCert        ,ii.Proposition65LabelReq        ,ii.CCCR        ,ii.FormaldehydeCompliant        ,ii.Is_Valid          ,ii.Tax_Wizard        ,ii.RMS_Sellable        ,ii.RMS_Orderable        ,ii.RMS_Inventory        ,ii.Parent_ID        ,ii.RegularBatchItem        ,ii.Sequence          ,ii.Store_Total        ,ii.POG_Start_Date        ,ii.POG_Comp_Date        ,ii.Like_Item_SKU        ,ii.Like_Item_Description        ,ii.Like_Item_Retail          ,ii.Like_Item_Regular_Unit        ,ii.Like_Item_Sales        ,ii.Facings        ,ii.POG_Min_Qty        ,ii.Displayer_Cost        ,ii.Product_Cost        ,ii.Calculate_Options          ,ii.Like_Item_Store_Count        ,ii.Like_Item_Unit_Store_Month        ,ii.Annual_Reg_Retail_Sales        ,ii.Annual_Regular_Unit_Forecast        ,ii.Inner_Pack        ,ii.Min_Pres_Per_Facing,      COALESCE(lv.Display_Text, '''') as Private_Brand_Label  ,ii.QuoteReferenceNumber, ii.Customs_Description,   l1.Package_Language_Indicator as Package_Language_Indicator_English,   l2.Package_Language_Indicator as Package_Language_Indicator_French,   l3.Package_Language_Indicator as Package_Language_Indicator_Spanish,   l1.Translation_Indicator as Translation_Indicator_English,   l2.Translation_Indicator as Translation_Indicator_French,   l3.Translation_Indicator as Translation_Indicator_Spanish, l1.Description_Short as English_Short_Description, l1.Description_Long as English_Long_Description  ,l2.Description_Short as French_Short_Description, l2.Description_Long as French_Long_Description, l3.Description_Short as Spanish_Short_Description, l3.Description_Long as Spanish_Long_Description  ,b.Date_Modified as Last_Modified,     case      when isnull(f1.[File_ID], 0) > 0 then ''<a href="getimage.aspx?id='' + convert(varchar(20), f1.[File_ID]) + ''" target="_blank">Image</a>''      else ''''    end as Item_Image,        case      when isnull(f2.[File_ID], 0) > 0 then ''<a href="getfile.aspx?ad=1&id='' + convert(varchar(20), f2.[File_ID]) + ''&filename=importitem_'' + convert(varchar(20), b.ID) + ''_'' + @dateNowStr + ''.pdf">MSDS Sheet</a>''      else ''''    end as MSDS_Sheet      from [SPD_Import_Items] ii         inner join [SPD_Batch] b on ii.Batch_ID = b.ID        left outer join SPD_Workflow_Stage ws on b.Workflow_Stage_ID = ws.id and ws.Workflow_id = 1        LEFT OUTER JOIN [SPD_Items_Files] f1 ON f1.Item_Type = ''I'' and f1.Item_ID = ii.[ID] and f1.File_Type = ''IMG''         LEFT OUTER JOIN [SPD_Items_Files] f2 ON f2.Item_Type = ''I'' and f2.Item_ID = ii.[ID] and f2.File_Type = ''MSDS''       LEFT OUTER JOIN SPD_Import_Item_Languages as l1 on l1.Import_Item_ID = ii.ID AND l1.Language_Type_ID = 1    LEFT OUTER JOIN SPD_Import_Item_Languages as l2 on l2.Import_Item_ID = ii.ID AND l2.Language_Type_ID = 2    LEFT OUTER JOIN SPD_Import_Item_Languages as l3 on l3.Import_Item_ID = ii.ID AND l3.Language_Type_ID = 3    LEFT OUTER JOIN List_Values as lv on lv.List_Value_Group_ID = 16 And ii.Private_Brand_Label = lv.List_Value    where     b.enabled = 1 and       (@startDate is null or (@startDate is not null and b.date_modified >= @startDate)) and    (@endDate is null or (@endDate is not null and b.date_modified <= @endDate)) and       (isnull(@dept, 0) = 0 or (isnull(@dept, 0) > 0 and b.Fineline_Dept_ID = @dept)) and    ((isnull(@stage, 0) = 0 and COALESCE(ws.Workflow_id, 1) = 1 and COALESCE(ws.Stage_Type_id, 1) <> 4) or (isnull(@stage, 0) > 0 and b.Workflow_Stage_ID = @stage)) and     ((isnull(@vendor, 0) <= 0) or (isnull(@vendor,0) > 0 and b.Vendor_Number = @vendor))  '
where rtrim(report_name) = 'Import Item Language';

--*****************************
--SPD_Metadata_Column
--*****************************
update SPD_Metadata_Column set 
Column_Name = 'ReshippableInnerCartonWeight',
Display_Name = 'Weight of Inner Carton',
Column_Generic_Type = 'decimal', Max_Length = null, Column_Format_String = null, Date_Last_Modified = GETDATE()
where Column_Name = 'EachPieceNetWeightLbsPerOunce' and Metadata_Table_ID = 1



--*****************************
--ColumnDisplayName
--*****************************
update ColumnDisplayName
set Column_Ordinal = 24
where Workflow_ID = 7 and Column_Name = 'FOBShippingPoint' and Display_Name = 'Total<br />Cost'

update ColumnDisplayName
set Column_Ordinal = 25
where Workflow_ID = 7 and Column_Name = 'ProductCost' and Display_Name = 'FOB First<br />Cost (US$)'

update ColumnDisplayName
set Column_Ordinal = 26
where Workflow_ID = 7 and Column_Name = 'FOBShippingPoint' and Display_Name = 'Total FOB First<br />Cost (US$)'



--*****************************
--List_Value_Groups
--*****************************
Insert into List_Value_Groups
(List_Value_Group, RMS_Group,RMS_UDA_ID,RMS_Name)
values
('STOCKSTRATSEASONAL',0,Null, Null)

Insert into List_Value_Groups
(List_Value_Group, RMS_Group,RMS_UDA_ID,RMS_Name)
values
('STOCKSTRATBASIC',0,Null, Null)

Insert into List_Value_Groups
(List_Value_Group, RMS_Group,RMS_UDA_ID,RMS_Name)
values
('STOCKSTRATALL',0,Null, Null)


--*****************************
--Import SPD_Item_Mapping
--*****************************
Insert into SPD_Item_Mapping 
([Default],Mapping_Name, Mapping_Version, Date_Created, Created_User_Id, Date_Last_modified, Update_User_Id, Enabled)
values
(0,'IMPORTITEM','15', GETDATE(),0,GETDATE(),0,1)

insert into SPD_Item_Mapping_Columns (Item_Mapping_ID, Column_Name, Excel_Column, Excel_Row) 
select 
(Select ID from SPD_Item_Mapping where mapping_name = 'IMPORTITEM' and Mapping_Version = '15')
, mc.Column_Name, mc.Excel_Column, mc.Excel_Row 
from SPD_Item_Mapping_Columns mc where mc.Item_Mapping_ID = 
(Select ID from SPD_Item_Mapping where mapping_name = 'IMPORTITEM' and Mapping_Version = '14.57')
	 
	
Insert into SPD_Item_Mapping_Columns
(Item_Mapping_ID, Column_Name, Excel_Column, Excel_Row) 
values
((Select ID from SPD_Item_Mapping where mapping_name = 'IMPORTITEM' and Mapping_Version = '15'),'eachlength','A',124)
	
Insert into SPD_Item_Mapping_Columns
(Item_Mapping_ID, Column_Name, Excel_Column, Excel_Row) 
values
((Select ID from SPD_Item_Mapping where mapping_name = 'IMPORTITEM' and Mapping_Version = '15'),'eachwidth','D',124)
	
Insert into SPD_Item_Mapping_Columns
(Item_Mapping_ID, Column_Name, Excel_Column, Excel_Row) 
values
((Select ID from SPD_Item_Mapping where mapping_name = 'IMPORTITEM' and Mapping_Version = '15'),'eachheight','J',124)
	
Insert into SPD_Item_Mapping_Columns
(Item_Mapping_ID, Column_Name, Excel_Column, Excel_Row) 
values
((Select ID from SPD_Item_Mapping where mapping_name = 'IMPORTITEM' and Mapping_Version = '15'),'cubicfeeteach','J',125)
	
Insert into SPD_Item_Mapping_Columns
(Item_Mapping_ID, Column_Name, Excel_Column, Excel_Row) 
values
((Select ID from SPD_Item_Mapping where mapping_name = 'IMPORTITEM' and Mapping_Version = '15'),'eachweight','J',126)
	
Insert into SPD_Item_Mapping_Columns
(Item_Mapping_ID, Column_Name, Excel_Column, Excel_Row) 
values
((Select ID from SPD_Item_Mapping where mapping_name = 'IMPORTITEM' and Mapping_Version = '15'),'Stocking_Strategy_Code','R',122)
	
Insert into SPD_Item_Mapping_Columns
(Item_Mapping_ID, Column_Name, Excel_Column, Excel_Row) 
values
((Select ID from SPD_Item_Mapping where mapping_name = 'IMPORTITEM' and Mapping_Version = '15'),'CanadaHarmonizedCodeNumber','F',45)

update SPD_Item_Mapping_Columns
set Column_Name = 'ReshippableInnerCartonWeight'
where 
Column_Name = 'EachPieceNetWeightLbsPerOunce' and 
Item_Mapping_ID = (Select ID from SPD_Item_Mapping where mapping_name = 'IMPORTITEM' and Mapping_Version = '15')


Insert into SPD_Item_Mapping_Columns
(Item_Mapping_ID, Column_Name, Excel_Column, Excel_Row) 
values
((Select ID from SPD_Item_Mapping where mapping_name = 'IMPORTITEM' and Mapping_Version = '15'),'EachCaseLength','A',124)
	
Insert into SPD_Item_Mapping_Columns
(Item_Mapping_ID, Column_Name, Excel_Column, Excel_Row) 
values
((Select ID from SPD_Item_Mapping where mapping_name = 'IMPORTITEM' and Mapping_Version = '15'),'EachCaseWidth','D',124)
	
Insert into SPD_Item_Mapping_Columns
(Item_Mapping_ID, Column_Name, Excel_Column, Excel_Row) 
values
((Select ID from SPD_Item_Mapping where mapping_name = 'IMPORTITEM' and Mapping_Version = '15'),'EachCaseHeight','J',124)
	
Insert into SPD_Item_Mapping_Columns
(Item_Mapping_ID, Column_Name, Excel_Column, Excel_Row) 
values
((Select ID from SPD_Item_Mapping where mapping_name = 'IMPORTITEM' and Mapping_Version = '15'),'EachCaseCube','J',125)
	
Insert into SPD_Item_Mapping_Columns
(Item_Mapping_ID, Column_Name, Excel_Column, Excel_Row) 
values
((Select ID from SPD_Item_Mapping where mapping_name = 'IMPORTITEM' and Mapping_Version = '15'),'EachCaseWeight','J',126)

--*****************************
--Domestic SPD_Item_Mapping
--*****************************

Insert into SPD_Item_Mapping 
([Default],Mapping_Name, Mapping_Version, Date_Created, Created_User_Id, Date_Last_modified, Update_User_Id, Enabled)
values
(0,'DOMITEMHEADER','16 Version', GETDATE(),0,GETDATE(),0,1)

Insert into SPD_Item_Mapping 
([Default],Mapping_Name, Mapping_Version, Date_Created, Created_User_Id, Date_Last_modified, Update_User_Id, Enabled)
values
(0,'DOMITEM','16 Version', GETDATE(),0,GETDATE(),0,1)


insert into SPD_Item_Mapping_Columns (Item_Mapping_ID, Column_Name, Excel_Column, Excel_Row) 
select 
(Select ID from SPD_Item_Mapping where mapping_name = 'DOMITEMHEADER' and Mapping_Version = '16 Version')
, mc.Column_Name, mc.Excel_Column, mc.Excel_Row 
from SPD_Item_Mapping_Columns mc where mc.Item_Mapping_ID = 
(Select ID from SPD_Item_Mapping where mapping_name = 'DOMITEMHEADER' and Mapping_Version = '15.5 Version')


insert into SPD_Item_Mapping_Columns (Item_Mapping_ID, Column_Name, Excel_Column, Excel_Row) 
select 
(Select ID from SPD_Item_Mapping where mapping_name = 'DOMITEM' and Mapping_Version = '16 Version')
, mc.Column_Name, mc.Excel_Column, mc.Excel_Row 
from SPD_Item_Mapping_Columns mc where mc.Item_Mapping_ID = 
(Select ID from SPD_Item_Mapping where mapping_name = 'DOMITEM' and Mapping_Version = '15.5 Version')

Insert into SPD_Item_Mapping_Columns
(Item_Mapping_ID, Column_Name, Excel_Column, Excel_Row) 
values
((Select ID from SPD_Item_Mapping where mapping_name = 'DOMITEM' and Mapping_Version = '16 Version'),'Each_Case_Height','CB',23)

Insert into SPD_Item_Mapping_Columns
(Item_Mapping_ID, Column_Name, Excel_Column, Excel_Row) 
values
((Select ID from SPD_Item_Mapping where mapping_name = 'DOMITEM' and Mapping_Version = '16 Version'),'Each_Case_Width','CC',23)

Insert into SPD_Item_Mapping_Columns
(Item_Mapping_ID, Column_Name, Excel_Column, Excel_Row) 
values
((Select ID from SPD_Item_Mapping where mapping_name = 'DOMITEM' and Mapping_Version = '16 Version'),'Each_Case_Length','CD',23)

Insert into SPD_Item_Mapping_Columns
(Item_Mapping_ID, Column_Name, Excel_Column, Excel_Row) 
values
((Select ID from SPD_Item_Mapping where mapping_name = 'DOMITEM' and Mapping_Version = '16 Version'),'Each_Case_Weight','CE',23)

Insert into SPD_Item_Mapping_Columns
(Item_Mapping_ID, Column_Name, Excel_Column, Excel_Row) 
values
((Select ID from SPD_Item_Mapping where mapping_name = 'DOMITEM' and Mapping_Version = '16 Version'),'Each_Case_Pack_Cube','CF',23)

Insert into SPD_Item_Mapping_Columns
(Item_Mapping_ID, Column_Name, Excel_Column, Excel_Row) 
values
((Select ID from SPD_Item_Mapping where mapping_name = 'DOMITEM' and Mapping_Version = '16 Version'),'Canada_Harmonized_Code_Number','CG',23)

Insert into SPD_Item_Mapping_Columns
(Item_Mapping_ID, Column_Name, Excel_Column, Excel_Row) 
values
((Select ID from SPD_Item_Mapping where mapping_name = 'DOMITEM' and Mapping_Version = '16 Version'),'Stocking_Strategy_Code','CH',23)


--*****************************
--BULK MAINT MAPPING
--*****************************

Insert into SPD_Item_Mapping_Columns
(Item_Mapping_ID, Column_Name, Excel_Column, Excel_Row) 
values
((Select ID from SPD_Item_Mapping where mapping_name = 'BULKMAINT' and Mapping_Version = '1.0'),'EachCaseHeight','BU',1)

Insert into SPD_Item_Mapping_Columns
(Item_Mapping_ID, Column_Name, Excel_Column, Excel_Row) 
values
((Select ID from SPD_Item_Mapping where mapping_name = 'BULKMAINT' and Mapping_Version = '1.0'),'EachCaseWidth','BV',1)

Insert into SPD_Item_Mapping_Columns
(Item_Mapping_ID, Column_Name, Excel_Column, Excel_Row) 
values
((Select ID from SPD_Item_Mapping where mapping_name = 'BULKMAINT' and Mapping_Version = '1.0'),'EachCaseLength','BW',1)

Insert into SPD_Item_Mapping_Columns
(Item_Mapping_ID, Column_Name, Excel_Column, Excel_Row) 
values
((Select ID from SPD_Item_Mapping where mapping_name = 'BULKMAINT' and Mapping_Version = '1.0'),'EachCaseWeight','BX',1)

Insert into SPD_Item_Mapping_Columns
(Item_Mapping_ID, Column_Name, Excel_Column, Excel_Row) 
values
((Select ID from SPD_Item_Mapping where mapping_name = 'BULKMAINT' and Mapping_Version = '1.0'),'CanadaHarmonizedCodeNumber','BY',1)

Insert into SPD_Item_Mapping_Columns
(Item_Mapping_ID, Column_Name, Excel_Column, Excel_Row) 
values
((Select ID from SPD_Item_Mapping where mapping_name = 'BULKMAINT' and Mapping_Version = '1.0'),'STOCKINGSTRATEGYCODE','BZ',1)

--*****************************
--Validation_Condition_Types: add new validation conditions
--*****************************

insert into Validation_Condition_Types
(ID, Condition,Enabled,IsLookup,Sort_Order,IsChange)
values
(49, 'Lookup - Inner Wt. Eaches Compare', 1, 1, 99, 0)

insert into Validation_Condition_Types
(ID, Condition,Enabled,IsLookup,Sort_Order,IsChange)
values
(50, 'Lookup - Master Wt. Eaches Compare', 1, 1, 99, 0)

insert into Validation_Condition_Types
(ID, Condition,Enabled,IsLookup,Sort_Order,IsChange)
values
(51, 'Lookup - Master Wt. Inner Eaches Ratio.', 1, 1, 99, 0)

--*****************************
--Validation_Condition_Types: reorder conditions
--*****************************
update Validation_Condition_Types set sort_order = 	15	where id = 	10
update Validation_Condition_Types set sort_order = 	16	where id = 	45
update Validation_Condition_Types set sort_order = 	17	where id = 	31
update Validation_Condition_Types set sort_order = 	18	where id = 	11
update Validation_Condition_Types set sort_order = 	19	where id = 	49
update Validation_Condition_Types set sort_order = 	20	where id = 	50
update Validation_Condition_Types set sort_order = 	21	where id = 	51
update Validation_Condition_Types set sort_order = 	22	where id = 	38
update Validation_Condition_Types set sort_order = 	23	where id = 	46
update Validation_Condition_Types set sort_order = 	24	where id = 	34
update Validation_Condition_Types set sort_order = 	25	where id = 	39
update Validation_Condition_Types set sort_order = 	26	where id = 	41
update Validation_Condition_Types set sort_order = 	27	where id = 	40
update Validation_Condition_Types set sort_order = 	28	where id = 	35
update Validation_Condition_Types set sort_order = 	29	where id = 	42
update Validation_Condition_Types set sort_order = 	30	where id = 	12
update Validation_Condition_Types set sort_order = 	31	where id = 	13
update Validation_Condition_Types set sort_order = 	32	where id = 	14
update Validation_Condition_Types set sort_order = 	33	where id = 	15
update Validation_Condition_Types set sort_order = 	34	where id = 	36
update Validation_Condition_Types set sort_order = 	35	where id = 	37
update Validation_Condition_Types set sort_order = 	36	where id = 	47
update Validation_Condition_Types set sort_order = 	37	where id = 	48
update Validation_Condition_Types set sort_order = 	38	where id = 	16
update Validation_Condition_Types set sort_order = 	39	where id = 	17
update Validation_Condition_Types set sort_order = 	40	where id = 	29
update Validation_Condition_Types set sort_order = 	41	where id = 	19
update Validation_Condition_Types set sort_order = 	42	where id = 	18
update Validation_Condition_Types set sort_order = 	43	where id = 	20
update Validation_Condition_Types set sort_order = 	44	where id = 	21
update Validation_Condition_Types set sort_order = 	45	where id = 	22
update Validation_Condition_Types set sort_order = 	46	where id = 	23
update Validation_Condition_Types set sort_order = 	47	where id = 	24
update Validation_Condition_Types set sort_order = 	48	where id = 	25
update Validation_Condition_Types set sort_order = 	49	where id = 	26
update Validation_Condition_Types set sort_order = 	50	where id = 	27
update Validation_Condition_Types set sort_order = 	51	where id = 	28


--REPORT UPDATES
Update SPD_Report
set Report_SQL = 
'declare @dateNow datetime    declare @dateNowStr varchar(20)    declare @month varchar(2), @day varchar(2), @year varchar(4)        set @dateNow = getdate()    set @month = convert(varchar(2), Month(@dateNow))      if (len(@month) < 2)       set @month = ''0'' + @month      set @day = convert(varchar(2), Day(@dateNow))    if (len(@day) < 2)       set @day = ''0'' + @day      set @year = convert(varchar(4), Year(@dateNow))    if (len(@year) < 4)       set @year = ''00'' + @year      set @dateNowStr =  @year + @month + @day      select     ii.ID        ,ii.Batch_ID        ,ii.DateCreated        ,ii.DateLastModified        ,ii.CreatedUserID        ,ii.UpdateUserID        ,ii.DateSubmitted        ,ii.Vendor        ,ii.Agent As MerchBurden        ,ii.AgentType As MerchBurdenType        ,ii.Buyer        ,ii.Fax        ,ii.EnteredBy        ,ii.QuoteSheetStatus        ,ii.Season        ,ii.SKUGroup        ,ii.Email        ,ii.EnteredDate        ,ii.Dept        ,ii.Class        ,ii.SubClass        ,ii.PrimaryUPC        ,ii.MichaelsSKU as SKU        ,ii.GenerateMichaelsUPC as GenerateUPC       ,ii.AdditionalUPC1        ,ii.AdditionalUPC2        ,ii.AdditionalUPC3        ,ii.AdditionalUPC4        ,ii.AdditionalUPC5        ,ii.AdditionalUPC6        ,ii.AdditionalUPC7        ,ii.AdditionalUPC8        ,ii.PackSKU        ,ii.PlanogramName        ,ii.VendorNumber        ,ii.VendorRank        ,ii.ItemTask        ,ii.Description        ,ii.PaymentTerms        ,ii.Days        ,ii.VendorMinOrderAmount        ,ii.VendorName        ,ii.VendorAddress1        ,ii.VendorAddress2        ,ii.VendorAddress3        ,ii.VendorAddress4        ,ii.VendorContactName        ,ii.VendorContactPhone        ,ii.VendorContactEmail        ,ii.VendorContactFax        ,ii.ManufactureName        ,ii.ManufactureAddress1        ,ii.ManufactureAddress2        ,ii.ManufactureContact        ,ii.ManufacturePhone        ,ii.ManufactureEmail        ,ii.ManufactureFax        ,ii.AgentContact        ,ii.AgentPhone        ,ii.AgentEmail        ,ii.AgentFax        ,ii.VendorStyleNumber        ,ii.HarmonizedCodeNumber, ii.CanadaHarmonizedCodeNumber        ,ii.DetailInvoiceCustomsDesc        ,ii.ComponentMaterialBreakdown        ,ii.ComponentConstructionMethod        ,ii.IndividualItemPackaging        ,ii.EachInsideMasterCaseBox        ,ii.EachInsideInnerPack        ,ii.eachweight as EachCartonWeight,  ii.eachlength as EachCartonLength, ii.eachwidth as EachCartonWidth,ii.eachheight as EachCartonHeight,ii.cubicfeeteach as CubicFeetPerEachCarton, ii.ReshippableInnerCartonWeight        ,ii.ReshippableInnerCartonLength        ,ii.ReshippableInnerCartonWidth        ,ii.ReshippableInnerCartonHeight        ,ii.MasterCartonDimensionsLength        ,ii.MasterCartonDimensionsWidth        ,ii.MasterCartonDimensionsHeight        ,ii.CubicFeetPerMasterCarton        ,ii.WeightMasterCarton        ,ii.CubicFeetPerInnerCarton        ,ii.FOBShippingPoint        ,ii.DutyPercent        ,ii.DutyAmount        ,ii.AdditionalDutyComment        ,ii.AdditionalDutyAmount        ,ii.OceanFreightAmount        ,ii.OceanFreightComputedAmount        ,ii.AgentCommissionPercent As MerchBurdenPercent        ,ii.AgentCommissionAmount As MerchBurdenAmount        ,ii.OtherImportCostsPercent        ,ii.OtherImportCostsAmount        ,ii.PackagingCostAmount        ,ii.TotalImportBurden        ,ii.WarehouseLandedCost        ,ii.PurchaseOrderIssuedTo        ,ii.ShippingPoint        ,ii.CountryOfOrigin        ,ii.CountryOfOriginName        ,ii.VendorComments        ,ii.StockCategory        ,ii.FreightTerms        ,ii.ItemType        ,ii.PackItemIndicator        ,ii.ItemTypeAttribute        ,ii.AllowStoreOrder        ,ii.InventoryControl        ,ii.AutoReplenish        ,ii.PrePriced        ,ii.TaxUDA        ,ii.PrePricedUDA        ,ii.TaxValueUDA        ,ii.Stocking_Strategy_Code       ,ii.StoreSuppZoneGRP        ,ii.WhseSuppZoneGRP        ,ii.POGMaxQty        ,ii.POGSetupPerStore as Initial_Set_Qty_Per_Store    ,ii.OutboundFreight        ,ii.NinePercentWhseCharge        ,ii.TotalStoreLandedCost        ,ii.RDBase as Base1_Retail        ,ii.RDCentral as Base2_Retail        ,ii.RDTest as Test_Retail        ,ii.RDAlaska as Alaska_Retail        ,ii.RDCanada as Canada_Retail        ,ii.RD0Thru9 as High2_Retail        ,ii.RDCalifornia as High3_Retail        ,ii.RDVillageCraft as Small_Market_Retail     ,ii.Retail9 as High1_Retail        ,ii.Retail10 as Base3_Retail        ,ii.Retail11 as Low1_Retail        ,ii.Retail12 as Low2_Retail        ,ii.Retail13 as Manhattan_Retail        ,ii.HazMatYes        ,ii.HazMatNo        ,ii.HazMatMFGCountry        ,ii.HazMatMFGName        ,ii.HazMatMFGFlammable        ,ii.HazMatMFGCity        ,ii.HazMatContainerType        ,ii.HazMatMFGState        ,ii.HazMatContainerSize        ,ii.HazMatMFGPhone        ,ii.HazMatMSDSUOM        ,ii.TSSA        ,ii.CSA        ,ii.UL        ,ii.LicenceAgreement        ,ii.FumigationCertificate        ,ii.KILNDriedCertificate        ,ii.ChinaComInspecNumAndCCIBStickers        ,ii.OriginalVisa        ,ii.TextileDeclarationMidCode        ,ii.QuotaChargeStatement        ,ii.MSDS        ,ii.TSCA        ,ii.DropBallTestCert        ,ii.ManMedicalDeviceListing        ,ii.ManFDARegistration        ,ii.CopyRightIndemnification        ,ii.FishWildLifeCert        ,ii.Proposition65LabelReq        ,ii.CCCR        ,ii.FormaldehydeCompliant        ,ii.Is_Valid        ,ii.Tax_Wizard        ,ii.RMS_Sellable        ,ii.RMS_Orderable        ,ii.RMS_Inventory        ,ii.Parent_ID        ,ii.RegularBatchItem        ,ii.Sequence        ,ii.Store_Total        ,ii.POG_Start_Date        ,ii.POG_Comp_Date        ,ii.Like_Item_SKU        ,ii.Like_Item_Description        ,ii.Like_Item_Retail        ,ii.Like_Item_Regular_Unit        ,ii.Like_Item_Sales        ,ii.Facings        ,ii.POG_Min_Qty        ,ii.Displayer_Cost        ,ii.Product_Cost        ,ii.Calculate_Options        ,ii.Like_Item_Store_Count        ,ii.Like_Item_Unit_Store_Month        ,ii.Annual_Reg_Retail_Sales        ,ii.Annual_Regular_Unit_Forecast        ,ii.Inner_Pack        ,ii.Min_Pres_Per_Facing,    b.Date_Modified as Last_Modified,      case      when isnull(f1.[File_ID], 0) > 0 then ''<a href="getimage.aspx?id='' + convert(varchar(20), f1.[File_ID]) + ''" target="_blank">Image</a>''      else ''''    end as Item_Image,      case      when isnull(f2.[File_ID], 0) > 0 then ''<a href="getfile.aspx?ad=1&id='' + convert(varchar(20), f2.[File_ID]) + ''&filename=importitem_'' + convert(varchar(20), b.ID) + ''_'' + @dateNowStr + ''.pdf">MSDS Sheet</a>''      else ''''    end as MSDS_Sheet    from [SPD_Import_Items] ii       inner join [SPD_Batch] b on ii.Batch_ID = b.ID      left outer join SPD_Workflow_Stage ws on b.Workflow_Stage_ID = ws.id and ws.Workflow_id = 1      LEFT OUTER JOIN [SPD_Items_Files] f1 ON f1.Item_Type = ''I'' and f1.Item_ID = ii.[ID] and f1.File_Type = ''IMG''       LEFT OUTER JOIN [SPD_Items_Files] f2 ON f2.Item_Type = ''I'' and f2.Item_ID = ii.[ID] and f2.File_Type = ''MSDS''     where     b.enabled = 1 and       (isnull(ii.HazMatYes, '''') != '''') and       (@startDate is null or (@startDate is not null and b.date_modified >= @startDate)) and    (@endDate is null or (@endDate is not null and b.date_modified <= @endDate)) and       (isnull(@dept, 0) = 0 or (isnull(@dept, 0) > 0 and b.Fineline_Dept_ID = @dept)) and    ( (isnull(@stage, 0) = 0 and COALESCE(ws.Workflow_id, 1) = 1 and COALESCE(ws.Stage_Type_id, 1) <> 4 ) or (isnull(@stage, 0) > 0 and b.Workflow_Stage_ID = @stage)) and    ((isnull(@vendor, 0) <= 0) or (isnull(@vendor,0) > 0 and b.Vendor_Number = @vendor))  '
where rtrim(report_name) = 'Import Item Chemical Inventory';

Update SPD_Report
set Report_SQL = 
'declare @dateNow datetime  declare @dateNowStr varchar(20)  declare @month varchar(2), @day varchar(2), @year varchar(4)  set @dateNow = getdate()  set @month = convert(varchar(2), Month(@dateNow))  if (len(@month) < 2)    set @month = ''0'' + @month  set @day = convert(varchar(2), Day(@dateNow))  if (len(@day) < 2)    set @day = ''0'' + @day  set @year = convert(varchar(4), Year(@dateNow))  if (len(@year) < 4)    set @year = ''00'' + @year  set @dateNowStr =  @year + @month + @day    select     ih.*,    i.ID        ,i.Item_Header_ID        ,i.Add_Change        ,i.Pack_Item_Indicator        ,i.Michaels_SKU as SKU        ,i.Vendor_UPC        ,i.Class_Num        ,i.Sub_Class_Num        ,i.Vendor_Style_Num        ,i.Harmonized_Code_Number, i.Canada_Harmonized_Code_number, i.Item_Desc        ,i.Stocking_Strategy_Code       ,i.Eaches_Master_Case        ,i.Eaches_Inner_Pack        ,i.Pre_Priced        ,i.Pre_Priced_UDA        ,i.US_Cost        ,i.Canada_Cost        ,i.Base_Retail as Base1_Retail        ,i.Central_Retail as Base2_Retail        ,i.Test_Retail        ,i.Alaska_Retail        ,i.Canada_Retail        ,i.Zero_Nine_Retail as High2_Retail        ,i.California_Retail as High3_Retail        ,i.Village_Craft_Retail as Small_Market_Retail     ,i.Retail9 as High1_Retail        ,i.Retail10 as Base3_Retail        ,i.Retail11 as Low1_Retail        ,i.Retail12 as Low2_Retail        ,i.Retail13 as Manhattan_Retail        ,i.POG_Setup_Per_Store as Initial_Set_Qty_Per_Store        ,i.POG_Max_Qty        ,i.Each_Case_Height        ,i.Each_Case_Width        ,i.Each_Case_Length        ,i.Each_Case_Weight        ,i.Each_Case_Pack_Cube        ,i.Inner_Case_Height        ,i.Inner_Case_Width        ,i.Inner_Case_Length        ,i.Inner_Case_Weight        ,i.Inner_Case_Pack_Cube        ,i.Master_Case_Height        ,i.Master_Case_Width        ,i.Master_Case_Length        ,i.Master_Case_Weight        ,i.Master_Case_Pack_Cube        ,i.Country_Of_Origin        ,i.Country_Of_Origin_Name        ,i.Tax_UDA        ,i.Tax_Value_UDA        ,i.Hazardous        ,i.Hazardous_Flammable        ,i.Hazardous_Container_Type        ,i.Hazardous_Container_Size        ,i.Hazardous_MSDS_UOM        ,i.Hazardous_Manufacturer_Name        ,i.Hazardous_Manufacturer_City        ,i.Hazardous_Manufacturer_State        ,i.Hazardous_Manufacturer_Phone        ,i.Hazardous_Manufacturer_Country        ,i.MSDS_ID        ,i.Image_ID        ,i.Tax_Wizard        ,i.Date_Created        ,i.Created_User_ID        ,i.Date_Last_Modified        ,i.Update_User_ID        ,i.Is_Valid        ,i.Like_Item_SKU        ,i.Like_Item_Description        ,i.Like_Item_Retail        ,i.Like_Item_Regular_Unit        ,i.Like_Item_Sales        ,i.Facings        ,i.POG_Min_Qty        ,i.Like_Item_Store_Count        ,i.Annual_Regular_Unit_Forecast        ,i.Annual_Reg_Retail_Sales        ,i.Like_Item_Unit_Store_Month,    b.Date_Modified as Last_Modified,    case      when isnull(f1.[File_ID], 0) > 0 then ''<a href="getimage.aspx?id='' + convert(varchar(20), f1.[File_ID]) + ''" target="_blank">Image</a>''      else ''''    end as Item_Image,    case      when isnull(f2.[File_ID], 0) > 0 then ''<a href="getfile.aspx?ad=1&id='' + convert(varchar(20), f2.[File_ID]) + ''&filename=importitem_'' + convert(varchar(20), b.ID) + ''_'' + @dateNowStr + ''.pdf">MSDS Sheet</a>''      else ''''    end as MSDS_Sheet  from [SPD_Items] i     inner join [SPD_Item_Headers] ih on i.Item_Header_ID = ih.ID    inner join [SPD_Batch] b on ih.Batch_ID = b.ID    left outer join SPD_Workflow_Stage ws on b.Workflow_Stage_ID = ws.id and ws.Workflow_id = 1    LEFT OUTER JOIN [SPD_Items_Files] f1 ON f1.Item_Type = ''D'' and f1.Item_ID = i.[ID] and f1.File_Type = ''IMG''     LEFT OUTER JOIN [SPD_Items_Files] f2 ON f2.Item_Type = ''D'' and f2.Item_ID = i.[ID] and f2.File_Type = ''MSDS''   where     b.enabled = 1 and     (isnull(i.Hazardous, '''') = ''Y'') and     (@startDate is null or (@startDate is not null and b.date_modified >= @startDate)) and    (@endDate is null or (@endDate is not null and b.date_modified <= @endDate)) and     (isnull(@dept, 0) = 0 or (isnull(@dept, 0) > 0 and b.Fineline_Dept_ID = @dept)) and    ( (isnull(@stage, 0) = 0 and COALESCE(ws.Workflow_id, 1) = 1 and COALESCE(ws.Stage_Type_id, 1) <> 4 ) or (isnull(@stage, 0) > 0 and b.Workflow_Stage_ID = @stage))    and ((isnull(@vendor, 0) <= 0) or (isnull(@vendor,0) > 0 and (ih.US_Vendor_Num = @vendor or ih.Canadian_Vendor_Num = @vendor)))   '
where rtrim(report_name) = 'Domestic Item Chemical Inventory';

Update SPD_Report
set Report_SQL = 
'declare @dateNow datetime      declare @dateNowStr varchar(20)      declare @month varchar(2), @day varchar(2), @year varchar(4)          set @dateNow = getdate()      set @month = convert(varchar(2), Month(@dateNow))      if (len(@month) < 2)          set @month = ''0'' + @month          set @day = convert(varchar(2), Day(@dateNow))    if (len(@day) < 2)         set @day = ''0'' + @day      set @year = convert(varchar(4), Year(@dateNow))      if (len(@year) < 4)          set @year = ''00'' + @year          set @dateNowStr =  @year + @month + @day            select     ih.*, i.ID, i.Item_Header_ID, i.Add_Change           ,i.Pack_Item_Indicator, i.Michaels_SKU as SKU        ,i.Vendor_UPC        ,i.Class_Num        ,i.Sub_Class_Num        ,i.Vendor_Style_Num        ,i.Harmonized_Code_Number, i.Canada_Harmonized_Code_number, i.Item_Desc, i.Stocking_Strategy_Code      ,i.Eaches_Master_Case        ,i.Eaches_Inner_Pack        ,i.Pre_Priced        ,i.Pre_Priced_UDA        ,i.US_Cost        ,i.Canada_Cost        ,i.Base_Retail as Base1_Retail        ,i.Central_Retail as Base2_Retail        ,i.Test_Retail        ,i.Alaska_Retail        ,i.Canada_Retail        ,i.Zero_Nine_Retail as High2_Retail        ,i.California_Retail as High3_Retail        ,i.Village_Craft_Retail as Small_Market_Retail     ,i.Retail9 as High1_Retail        ,i.Retail10 as Base3_Retail        ,i.Retail11 as Low1_Retail        ,i.Retail12 as Low2_Retail           ,i.Retail13 as Manhattan_Retail, i.RDQuebec as Q5_Retail, i.RDPuertoRico as PR_Retail        ,i.POG_Setup_Per_Store as Initial_Set_Qty_Per_Store        ,i.POG_Max_Qty          ,i.Each_Case_Height        ,i.Each_Case_Width        ,i.Each_Case_Length        ,i.Each_Case_Weight        ,i.Each_Case_Pack_Cube        ,i.Inner_Case_Height        ,i.Inner_Case_Width        ,i.Inner_Case_Length        ,i.Inner_Case_Weight        ,i.Inner_Case_Pack_Cube        ,i.Master_Case_Height        ,i.Master_Case_Width          ,i.Master_Case_Length        ,i.Master_Case_Weight        ,i.Master_Case_Pack_Cube        ,i.Country_Of_Origin        ,i.Country_Of_Origin_Name        ,i.Tax_UDA        ,i.Tax_Value_UDA          ,i.Hazardous        ,i.Hazardous_Flammable        ,i.Hazardous_Container_Type        ,i.Hazardous_Container_Size        ,i.Hazardous_MSDS_UOM        ,i.Hazardous_Manufacturer_Name          ,i.Hazardous_Manufacturer_City        ,i.Hazardous_Manufacturer_State        ,i.Hazardous_Manufacturer_Phone        ,i.Hazardous_Manufacturer_Country        ,i.MSDS_ID          ,i.Image_ID        ,i.Tax_Wizard        ,i.Date_Created        ,i.Created_User_ID        ,i.Date_Last_Modified        ,i.Update_User_ID        ,i.Is_Valid          ,i.Like_Item_SKU        ,i.Like_Item_Description        ,i.Like_Item_Retail        ,i.Like_Item_Regular_Unit        ,i.Like_Item_Sales        ,i.Facings        ,i.POG_Min_Qty          ,i.Like_Item_Store_Count        ,i.Annual_Regular_Unit_Forecast        ,i.Annual_Reg_Retail_Sales        ,i.Like_Item_Unit_Store_Month,    b.Date_Modified as Last_Modified, COALESCE(lv.Display_Text, '''') as Private_Brand_Label  ,i.Customs_Description,   l1.Package_Language_Indicator as  Package_Language_Indicator_English,      l2.Package_Language_Indicator as  Package_Language_Indicator_French,   l3.Package_Language_Indicator as  Package_Language_Indicator_Spanish,   l1.Translation_Indicator as  Translation_Indicator_English,      l2.Translation_Indicator as  Translation_Indicator_French,   l3.Translation_Indicator as  Translation_Indicator_Spanish, l1.Description_Long as English_Long_Description, l1.Description_Short as English_Short_Description  ,l2.Description_Long as French_Long_Description, l2.Description_Short as French_Short_Description  ,l3.Description_Long as Spanish_Long_Description, l3.Description_Short as Spanish_Short_Description  ,case      when isnull(f1.[File_ID], 0) > 0 then ''<a href="getimage.aspx?id='' + convert(varchar(20), f1.[File_ID]) + ''" target="_blank">Image</a>''      else ''''    end as Item_Image      ,case      when isnull(f2.[File_ID], 0) > 0 then ''<a href="getfile.aspx?ad=1&id='' + convert(varchar(20), f2.[File_ID]) + ''&filename=importitem_'' + convert(varchar(20), b.ID) + ''_'' + @dateNowStr + ''.pdf">MSDS Sheet</a>''      else ''''    end as MSDS_Sheet      from [SPD_Items] i         inner join [SPD_Item_Headers] ih on i.Item_Header_ID = ih.ID        inner join [SPD_Batch] b on ih.Batch_ID = b.ID        left outer join SPD_Workflow_Stage ws on b.Workflow_Stage_ID = ws.id and ws.Workflow_id = 1        LEFT OUTER JOIN [SPD_Items_Files] f1 ON f1.Item_Type = ''D'' and f1.Item_ID = i.[ID] and f1.File_Type = ''IMG''         LEFT OUTER JOIN [SPD_Items_Files] f2 ON f2.Item_Type = ''D'' and f2.Item_ID = i.[ID] and f2.File_Type = ''MSDS''       LEFT OUTER JOIN SPD_Item_Languages as l1 on l1.Item_ID = i.ID And l1.Language_Type_ID = 1    LEFT OUTER JOIN SPD_Item_Languages as l2 on l2.Item_ID = i.ID And l2.Language_Type_ID = 2    LEFT OUTER JOIN SPD_Item_Languages as l3 on l3.Item_ID = i.ID And l3.Language_Type_ID = 3    LEFT OUTER JOIN List_Values as lv on lv.List_Value_Group_ID = 16 And i.Private_Brand_Label = lv.List_Value    where     b.enabled = 1 and        (@startDate is null or (@startDate is not null and b.date_modified >= @startDate)) and      (@endDate is null or (@endDate is not null and b.date_modified <= @endDate)) and   (isnull(@dept, 0) = 0 or (isnull(@dept, 0) > 0 and b.Fineline_Dept_ID = @dept)) and      ( (isnull(@stage, 0) = 0 and COALESCE(ws.Workflow_id, 1) = 1 and COALESCE(ws.Stage_Type_id, 1) <> 4 ) or (isnull(@stage, 0) > 0 and b.Workflow_Stage_ID = @stage)) and   ((isnull(@vendor, 0) <= 0) or (isnull(@vendor,0) > 0 and (ih.US_Vendor_Num = @vendor or ih.Canadian_Vendor_Num = @vendor)))  '
where rtrim(report_name) = 'Domestic Item Language';

--*****************************
--SPD_Report: Import Item Language report
--*****************************
Update SPD_Report
set Report_SQL = 
'declare @dateNow datetime      declare @dateNowStr varchar(20)      declare @month varchar(2), @day varchar(2), @year varchar(4)          set @dateNow = getdate()      set @month = convert(varchar(2), Month(@dateNow))      if (len(@month) < 2)          set @month = ''0'' + @month          set @day = convert(varchar(2), Day(@dateNow))      if (len(@day) < 2)          set @day = ''0'' + @day          set @year = convert(varchar(4), Year(@dateNow))      if (len(@year) < 4)          set @year = ''00'' + @year           set @dateNowStr =  @year + @month + @day        select     ii.ID        ,ii.Batch_ID        ,ii.DateCreated        ,ii.DateLastModified        ,ii.CreatedUserID        ,ii.UpdateUserID          ,ii.DateSubmitted        ,ii.Vendor        ,ii.Agent As MerchBurden        ,ii.AgentType As MerchBurdenType        ,ii.Buyer        ,ii.Fax        ,ii.EnteredBy        ,ii.QuoteSheetStatus          ,ii.Season        ,ii.SKUGroup        ,ii.Email        ,ii.EnteredDate        ,ii.Dept        ,ii.Class        ,ii.SubClass        ,ii.PrimaryUPC          ,ii.MichaelsSKU as SKU       ,ii.GenerateMichaelsUPC as GenerateUPC   ,ii.AdditionalUPC1        ,ii.AdditionalUPC2        ,ii.AdditionalUPC3        ,ii.AdditionalUPC4          ,ii.AdditionalUPC5        ,ii.AdditionalUPC6        ,ii.AdditionalUPC7        ,ii.AdditionalUPC8        ,ii.PackSKU        ,ii.PlanogramName          ,ii.VendorNumber        ,ii.VendorRank        ,ii.ItemTask        ,ii.Description        ,ii.PaymentTerms        ,ii.Days        ,ii.VendorMinOrderAmount          ,ii.VendorName        ,ii.VendorAddress1        ,ii.VendorAddress2        ,ii.VendorAddress3        ,ii.VendorAddress4        ,ii.VendorContactName          ,ii.VendorContactPhone        ,ii.VendorContactEmail        ,ii.VendorContactFax        ,ii.ManufactureName        ,ii.ManufactureAddress1          ,ii.ManufactureAddress2        ,ii.ManufactureContact        ,ii.ManufacturePhone        ,ii.ManufactureEmail        ,ii.ManufactureFax          ,ii.AgentContact        ,ii.AgentPhone        ,ii.AgentEmail        ,ii.AgentFax        ,ii.VendorStyleNumber        ,ii.HarmonizedCodeNumber, ii.CanadaHarmonizedCodeNumber           ,ii.DetailInvoiceCustomsDesc        ,ii.ComponentMaterialBreakdown        ,ii.ComponentConstructionMethod        ,ii.IndividualItemPackaging          ,ii.EachInsideMasterCaseBox        ,ii.EachInsideInnerPack        ,ii.eachweight as EachCartonWeight,  ii.eachlength as EachCartonLength, ii.eachwidth as EachCartonWidth, ii.eachheight as EachCartonHeight, ii.cubicfeeteach as CubicFeetPerEachCarton, ii.ReshippableInnerCartonWeight          ,ii.ReshippableInnerCartonLength          ,ii.ReshippableInnerCartonWidth        ,ii.ReshippableInnerCartonHeight        ,ii.MasterCartonDimensionsLength        ,ii.MasterCartonDimensionsWidth          ,ii.MasterCartonDimensionsHeight        ,ii.CubicFeetPerMasterCarton        ,ii.WeightMasterCarton        ,ii.CubicFeetPerInnerCarton        ,ii.FOBShippingPoint          ,ii.DutyPercent        ,ii.DutyAmount        ,ii.AdditionalDutyComment        ,ii.AdditionalDutyAmount        ,ii.OceanFreightAmount        ,ii.OceanFreightComputedAmount          ,ii.AgentCommissionPercent As MerchBurdenPercent        ,ii.AgentCommissionAmount As MerchBurdenAmount        ,ii.OtherImportCostsPercent        ,ii.OtherImportCostsAmount        ,ii.PackagingCostAmount          ,ii.TotalImportBurden        ,ii.WarehouseLandedCost        ,ii.PurchaseOrderIssuedTo        ,ii.ShippingPoint        ,ii.CountryOfOrigin          ,ii.CountryOfOriginName        ,ii.VendorComments        ,ii.StockCategory        ,ii.FreightTerms        ,ii.ItemType        ,ii.PackItemIndicator          ,ii.ItemTypeAttribute        ,ii.AllowStoreOrder        ,ii.InventoryControl        ,ii.AutoReplenish        ,ii.PrePriced        ,ii.TaxUDA          ,ii.PrePricedUDA        ,ii.TaxValueUDA        ,ii.Stocking_Strategy_Code      ,ii.StoreSuppZoneGRP          ,ii.WhseSuppZoneGRP        ,ii.POGMaxQty        ,ii.POGSetupPerStore as Initial_Set_Qty_Per_Store        ,ii.OutboundFreight        ,ii.NinePercentWhseCharge          ,ii.TotalStoreLandedCost        ,ii.RDBase as Base1_Retail        ,ii.RDCentral as Base2_Retail        ,ii.RDTest as Test_Retail        ,ii.RDAlaska as Alaska_Retail          ,ii.RDCanada as Canada_Retail        ,ii.RD0Thru9 as High2_Retail        ,ii.RDCalifornia as High3_Retail        ,ii.RDVillageCraft as Small_Market_Retail       ,ii.Retail9 as High1_Retail        ,ii.Retail10 as Base3_Retail        ,ii.Retail11 as Low1_Retail        ,ii.Retail12 as Low2_Retail          ,ii.Retail13 as Manhattan_Retail        ,ii.RDQuebec as Q5_Retail, ii.RDPuertoRico as PR_Retail ,ii.HazMatYes        ,ii.HazMatNo          ,ii.HazMatMFGCountry        ,ii.HazMatMFGName        ,ii.HazMatMFGFlammable        ,ii.HazMatMFGCity        ,ii.HazMatContainerType        ,ii.HazMatMFGState          ,ii.HazMatContainerSize        ,ii.HazMatMFGPhone        ,ii.HazMatMSDSUOM        ,ii.TSSA        ,ii.CSA        ,ii.UL        ,ii.LicenceAgreement          ,ii.FumigationCertificate        ,ii.KILNDriedCertificate        ,ii.ChinaComInspecNumAndCCIBStickers        ,ii.OriginalVisa        ,ii.TextileDeclarationMidCode          ,ii.QuotaChargeStatement        ,ii.MSDS        ,ii.TSCA        ,ii.DropBallTestCert        ,ii.ManMedicalDeviceListing        ,ii.ManFDARegistration          ,ii.CopyRightIndemnification        ,ii.FishWildLifeCert        ,ii.Proposition65LabelReq        ,ii.CCCR        ,ii.FormaldehydeCompliant        ,ii.Is_Valid          ,ii.Tax_Wizard        ,ii.RMS_Sellable        ,ii.RMS_Orderable        ,ii.RMS_Inventory        ,ii.Parent_ID        ,ii.RegularBatchItem        ,ii.Sequence          ,ii.Store_Total        ,ii.POG_Start_Date        ,ii.POG_Comp_Date        ,ii.Like_Item_SKU        ,ii.Like_Item_Description        ,ii.Like_Item_Retail          ,ii.Like_Item_Regular_Unit        ,ii.Like_Item_Sales        ,ii.Facings        ,ii.POG_Min_Qty        ,ii.Displayer_Cost        ,ii.Product_Cost        ,ii.Calculate_Options          ,ii.Like_Item_Store_Count        ,ii.Like_Item_Unit_Store_Month        ,ii.Annual_Reg_Retail_Sales        ,ii.Annual_Regular_Unit_Forecast        ,ii.Inner_Pack        ,ii.Min_Pres_Per_Facing,      COALESCE(lv.Display_Text, '''') as Private_Brand_Label  ,ii.QuoteReferenceNumber, ii.Customs_Description,   l1.Package_Language_Indicator as Package_Language_Indicator_English,   l2.Package_Language_Indicator as Package_Language_Indicator_French,   l3.Package_Language_Indicator as Package_Language_Indicator_Spanish,   l1.Translation_Indicator as Translation_Indicator_English,   l2.Translation_Indicator as Translation_Indicator_French,   l3.Translation_Indicator as Translation_Indicator_Spanish, l1.Description_Short as English_Short_Description, l1.Description_Long as English_Long_Description  ,l2.Description_Short as French_Short_Description, l2.Description_Long as French_Long_Description, l3.Description_Short as Spanish_Short_Description, l3.Description_Long as Spanish_Long_Description  ,b.Date_Modified as Last_Modified,     case      when isnull(f1.[File_ID], 0) > 0 then ''<a href="getimage.aspx?id='' + convert(varchar(20), f1.[File_ID]) + ''" target="_blank">Image</a>''      else ''''    end as Item_Image,        case      when isnull(f2.[File_ID], 0) > 0 then ''<a href="getfile.aspx?ad=1&id='' + convert(varchar(20), f2.[File_ID]) + ''&filename=importitem_'' + convert(varchar(20), b.ID) + ''_'' + @dateNowStr + ''.pdf">MSDS Sheet</a>''      else ''''    end as MSDS_Sheet      from [SPD_Import_Items] ii         inner join [SPD_Batch] b on ii.Batch_ID = b.ID        left outer join SPD_Workflow_Stage ws on b.Workflow_Stage_ID = ws.id and ws.Workflow_id = 1        LEFT OUTER JOIN [SPD_Items_Files] f1 ON f1.Item_Type = ''I'' and f1.Item_ID = ii.[ID] and f1.File_Type = ''IMG''         LEFT OUTER JOIN [SPD_Items_Files] f2 ON f2.Item_Type = ''I'' and f2.Item_ID = ii.[ID] and f2.File_Type = ''MSDS''       LEFT OUTER JOIN SPD_Import_Item_Languages as l1 on l1.Import_Item_ID = ii.ID AND l1.Language_Type_ID = 1    LEFT OUTER JOIN SPD_Import_Item_Languages as l2 on l2.Import_Item_ID = ii.ID AND l2.Language_Type_ID = 2    LEFT OUTER JOIN SPD_Import_Item_Languages as l3 on l3.Import_Item_ID = ii.ID AND l3.Language_Type_ID = 3    LEFT OUTER JOIN List_Values as lv on lv.List_Value_Group_ID = 16 And ii.Private_Brand_Label = lv.List_Value    where     b.enabled = 1 and       (@startDate is null or (@startDate is not null and b.date_modified >= @startDate)) and    (@endDate is null or (@endDate is not null and b.date_modified <= @endDate)) and       (isnull(@dept, 0) = 0 or (isnull(@dept, 0) > 0 and b.Fineline_Dept_ID = @dept)) and    ((isnull(@stage, 0) = 0 and COALESCE(ws.Workflow_id, 1) = 1 and COALESCE(ws.Stage_Type_id, 1) <> 4) or (isnull(@stage, 0) > 0 and b.Workflow_Stage_ID = @stage)) and     ((isnull(@vendor, 0) <= 0) or (isnull(@vendor,0) > 0 and b.Vendor_Number = @vendor))  '
where rtrim(report_name) = 'Import Item Language';

go

Update SPD_Report
set Report_SQL = 
'declare @dateNow datetime    declare @dateNowStr varchar(20)    declare @month varchar(2), @day varchar(2), @year varchar(4)        set @dateNow = getdate()    set @month = convert(varchar(2), Month(@dateNow))      if (len(@month) < 2)       set @month = ''0'' + @month      set @day = convert(varchar(2), Day(@dateNow))    if (len(@day) < 2)       set @day = ''0'' + @day      set @year = convert(varchar(4), Year(@dateNow))    if (len(@year) < 4)       set @year = ''00'' + @year      set @dateNowStr =  @year + @month + @day      select     ii.ID        ,ii.Batch_ID        ,ii.DateCreated        ,ii.DateLastModified        ,ii.CreatedUserID        ,ii.UpdateUserID        ,ii.DateSubmitted        ,ii.Vendor        ,ii.Agent As MerchBurden        ,ii.AgentType As MerchBurdenType        ,ii.Buyer        ,ii.Fax        ,ii.EnteredBy        ,ii.QuoteSheetStatus        ,ii.Season        ,ii.SKUGroup        ,ii.Email        ,ii.EnteredDate        ,ii.Dept        ,ii.Class        ,ii.SubClass        ,ii.PrimaryUPC        ,ii.MichaelsSKU as SKU        ,ii.GenerateMichaelsUPC as GenerateUPC       ,ii.AdditionalUPC1        ,ii.AdditionalUPC2        ,ii.AdditionalUPC3        ,ii.AdditionalUPC4        ,ii.AdditionalUPC5        ,ii.AdditionalUPC6        ,ii.AdditionalUPC7        ,ii.AdditionalUPC8        ,ii.PackSKU        ,ii.PlanogramName        ,ii.VendorNumber        ,ii.VendorRank        ,ii.ItemTask        ,ii.Description        ,ii.PaymentTerms        ,ii.Days        ,ii.VendorMinOrderAmount        ,ii.VendorName        ,ii.VendorAddress1        ,ii.VendorAddress2        ,ii.VendorAddress3        ,ii.VendorAddress4        ,ii.VendorContactName        ,ii.VendorContactPhone        ,ii.VendorContactEmail        ,ii.VendorContactFax        ,ii.ManufactureName        ,ii.ManufactureAddress1        ,ii.ManufactureAddress2        ,ii.ManufactureContact        ,ii.ManufacturePhone        ,ii.ManufactureEmail        ,ii.ManufactureFax        ,ii.AgentContact        ,ii.AgentPhone        ,ii.AgentEmail        ,ii.AgentFax        ,ii.VendorStyleNumber        ,ii.HarmonizedCodeNumber, ii.CanadaHarmonizedCodeNumber        ,ii.DetailInvoiceCustomsDesc        ,ii.ComponentMaterialBreakdown        ,ii.ComponentConstructionMethod        ,ii.IndividualItemPackaging        ,ii.EachInsideMasterCaseBox        ,ii.EachInsideInnerPack        ,ii.eachweight as EachCartonWeight,  ii.eachlength as EachCartonLength, ii.eachwidth as EachCartonWidth,ii.eachheight as EachCartonHeight,ii.cubicfeeteach as CubicFeetPerEachCarton, ii.ReshippableInnerCartonWeight        ,ii.ReshippableInnerCartonLength        ,ii.ReshippableInnerCartonWidth        ,ii.ReshippableInnerCartonHeight        ,ii.MasterCartonDimensionsLength        ,ii.MasterCartonDimensionsWidth        ,ii.MasterCartonDimensionsHeight        ,ii.CubicFeetPerMasterCarton        ,ii.WeightMasterCarton        ,ii.CubicFeetPerInnerCarton        ,ii.FOBShippingPoint        ,ii.DutyPercent        ,ii.DutyAmount        ,ii.AdditionalDutyComment        ,ii.AdditionalDutyAmount        ,ii.OceanFreightAmount        ,ii.OceanFreightComputedAmount        ,ii.AgentCommissionPercent As MerchBurdenPercent        ,ii.AgentCommissionAmount As MerchBurdenAmount        ,ii.OtherImportCostsPercent        ,ii.OtherImportCostsAmount        ,ii.PackagingCostAmount        ,ii.TotalImportBurden        ,ii.WarehouseLandedCost        ,ii.PurchaseOrderIssuedTo        ,ii.ShippingPoint        ,ii.CountryOfOrigin        ,ii.CountryOfOriginName        ,ii.VendorComments        ,ii.StockCategory        ,ii.FreightTerms        ,ii.ItemType        ,ii.PackItemIndicator        ,ii.ItemTypeAttribute        ,ii.AllowStoreOrder        ,ii.InventoryControl        ,ii.AutoReplenish        ,ii.PrePriced        ,ii.TaxUDA        ,ii.PrePricedUDA        ,ii.TaxValueUDA        ,ii.Stocking_Strategy_Code       ,ii.StoreSuppZoneGRP        ,ii.WhseSuppZoneGRP        ,ii.POGMaxQty        ,ii.POGSetupPerStore as Initial_Set_Qty_Per_Store    ,ii.OutboundFreight        ,ii.NinePercentWhseCharge        ,ii.TotalStoreLandedCost        ,ii.RDBase as Base1_Retail        ,ii.RDCentral as Base2_Retail        ,ii.RDTest as Test_Retail        ,ii.RDAlaska as Alaska_Retail        ,ii.RDCanada as Canada_Retail        ,ii.RD0Thru9 as High2_Retail        ,ii.RDCalifornia as High3_Retail        ,ii.RDVillageCraft as Small_Market_Retail     ,ii.Retail9 as High1_Retail        ,ii.Retail10 as Base3_Retail        ,ii.Retail11 as Low1_Retail        ,ii.Retail12 as Low2_Retail        ,ii.Retail13 as Manhattan_Retail        ,ii.HazMatYes        ,ii.HazMatNo        ,ii.HazMatMFGCountry        ,ii.HazMatMFGName        ,ii.HazMatMFGFlammable        ,ii.HazMatMFGCity        ,ii.HazMatContainerType        ,ii.HazMatMFGState        ,ii.HazMatContainerSize        ,ii.HazMatMFGPhone        ,ii.HazMatMSDSUOM        ,ii.TSSA        ,ii.CSA        ,ii.UL        ,ii.LicenceAgreement        ,ii.FumigationCertificate        ,ii.KILNDriedCertificate        ,ii.ChinaComInspecNumAndCCIBStickers        ,ii.OriginalVisa        ,ii.TextileDeclarationMidCode        ,ii.QuotaChargeStatement        ,ii.MSDS        ,ii.TSCA        ,ii.DropBallTestCert        ,ii.ManMedicalDeviceListing        ,ii.ManFDARegistration        ,ii.CopyRightIndemnification        ,ii.FishWildLifeCert        ,ii.Proposition65LabelReq        ,ii.CCCR        ,ii.FormaldehydeCompliant        ,ii.Is_Valid        ,ii.Tax_Wizard        ,ii.RMS_Sellable        ,ii.RMS_Orderable        ,ii.RMS_Inventory        ,ii.Parent_ID        ,ii.RegularBatchItem        ,ii.Sequence        ,ii.Store_Total        ,ii.POG_Start_Date        ,ii.POG_Comp_Date        ,ii.Like_Item_SKU        ,ii.Like_Item_Description        ,ii.Like_Item_Retail        ,ii.Like_Item_Regular_Unit        ,ii.Like_Item_Sales        ,ii.Facings        ,ii.POG_Min_Qty        ,ii.Displayer_Cost        ,ii.Product_Cost        ,ii.Calculate_Options        ,ii.Like_Item_Store_Count        ,ii.Like_Item_Unit_Store_Month        ,ii.Annual_Reg_Retail_Sales        ,ii.Annual_Regular_Unit_Forecast        ,ii.Inner_Pack        ,ii.Min_Pres_Per_Facing,    b.Date_Modified as Last_Modified,      case      when isnull(f1.[File_ID], 0) > 0 then ''<a href="getimage.aspx?id='' + convert(varchar(20), f1.[File_ID]) + ''" target="_blank">Image</a>''      else ''''    end as Item_Image,      case      when isnull(f2.[File_ID], 0) > 0 then ''<a href="getfile.aspx?ad=1&id='' + convert(varchar(20), f2.[File_ID]) + ''&filename=importitem_'' + convert(varchar(20), b.ID) + ''_'' + @dateNowStr + ''.pdf">MSDS Sheet</a>''      else ''''    end as MSDS_Sheet    from [SPD_Import_Items] ii       inner join [SPD_Batch] b on ii.Batch_ID = b.ID      left outer join SPD_Workflow_Stage ws on b.Workflow_Stage_ID = ws.id and ws.Workflow_id = 1      LEFT OUTER JOIN [SPD_Items_Files] f1 ON f1.Item_Type = ''I'' and f1.Item_ID = ii.[ID] and f1.File_Type = ''IMG''       LEFT OUTER JOIN [SPD_Items_Files] f2 ON f2.Item_Type = ''I'' and f2.Item_ID = ii.[ID] and f2.File_Type = ''MSDS''     where     b.enabled = 1 and       (isnull(ii.HazMatYes, '''') != '''') and       (@startDate is null or (@startDate is not null and b.date_modified >= @startDate)) and    (@endDate is null or (@endDate is not null and b.date_modified <= @endDate)) and       (isnull(@dept, 0) = 0 or (isnull(@dept, 0) > 0 and b.Fineline_Dept_ID = @dept)) and    ( (isnull(@stage, 0) = 0 and COALESCE(ws.Workflow_id, 1) = 1 and COALESCE(ws.Stage_Type_id, 1) <> 4 ) or (isnull(@stage, 0) > 0 and b.Workflow_Stage_ID = @stage)) and    ((isnull(@vendor, 0) <= 0) or (isnull(@vendor,0) > 0 and b.Vendor_Number = @vendor))  '
where rtrim(report_name) = 'Import Item Chemical Inventory';

Update SPD_Report
set Report_SQL = 
'declare @dateNow datetime  declare @dateNowStr varchar(20)  declare @month varchar(2), @day varchar(2), @year varchar(4)  set @dateNow = getdate()  set @month = convert(varchar(2), Month(@dateNow))  if (len(@month) < 2)    set @month = ''0'' + @month  set @day = convert(varchar(2), Day(@dateNow))  if (len(@day) < 2)    set @day = ''0'' + @day  set @year = convert(varchar(4), Year(@dateNow))  if (len(@year) < 4)    set @year = ''00'' + @year  set @dateNowStr =  @year + @month + @day    select     ih.*,    i.ID        ,i.Item_Header_ID        ,i.Add_Change        ,i.Pack_Item_Indicator        ,i.Michaels_SKU as SKU        ,i.Vendor_UPC        ,i.Class_Num        ,i.Sub_Class_Num        ,i.Vendor_Style_Num        ,i.Harmonized_Code_Number, i.Canada_Harmonized_Code_number, i.Item_Desc        ,i.Stocking_Strategy_Code       ,i.Eaches_Master_Case        ,i.Eaches_Inner_Pack        ,i.Pre_Priced        ,i.Pre_Priced_UDA        ,i.US_Cost        ,i.Canada_Cost        ,i.Base_Retail as Base1_Retail        ,i.Central_Retail as Base2_Retail        ,i.Test_Retail        ,i.Alaska_Retail        ,i.Canada_Retail        ,i.Zero_Nine_Retail as High2_Retail        ,i.California_Retail as High3_Retail        ,i.Village_Craft_Retail as Small_Market_Retail     ,i.Retail9 as High1_Retail        ,i.Retail10 as Base3_Retail        ,i.Retail11 as Low1_Retail        ,i.Retail12 as Low2_Retail        ,i.Retail13 as Manhattan_Retail        ,i.POG_Setup_Per_Store as Initial_Set_Qty_Per_Store        ,i.POG_Max_Qty        ,i.Each_Case_Height        ,i.Each_Case_Width        ,i.Each_Case_Length        ,i.Each_Case_Weight        ,i.Each_Case_Pack_Cube        ,i.Inner_Case_Height        ,i.Inner_Case_Width        ,i.Inner_Case_Length        ,i.Inner_Case_Weight        ,i.Inner_Case_Pack_Cube        ,i.Master_Case_Height        ,i.Master_Case_Width        ,i.Master_Case_Length        ,i.Master_Case_Weight        ,i.Master_Case_Pack_Cube        ,i.Country_Of_Origin        ,i.Country_Of_Origin_Name        ,i.Tax_UDA        ,i.Tax_Value_UDA        ,i.Hazardous        ,i.Hazardous_Flammable        ,i.Hazardous_Container_Type        ,i.Hazardous_Container_Size        ,i.Hazardous_MSDS_UOM        ,i.Hazardous_Manufacturer_Name        ,i.Hazardous_Manufacturer_City        ,i.Hazardous_Manufacturer_State        ,i.Hazardous_Manufacturer_Phone        ,i.Hazardous_Manufacturer_Country        ,i.MSDS_ID        ,i.Image_ID        ,i.Tax_Wizard        ,i.Date_Created        ,i.Created_User_ID        ,i.Date_Last_Modified        ,i.Update_User_ID        ,i.Is_Valid        ,i.Like_Item_SKU        ,i.Like_Item_Description        ,i.Like_Item_Retail        ,i.Like_Item_Regular_Unit        ,i.Like_Item_Sales        ,i.Facings        ,i.POG_Min_Qty        ,i.Like_Item_Store_Count        ,i.Annual_Regular_Unit_Forecast        ,i.Annual_Reg_Retail_Sales        ,i.Like_Item_Unit_Store_Month,    b.Date_Modified as Last_Modified,    case      when isnull(f1.[File_ID], 0) > 0 then ''<a href="getimage.aspx?id='' + convert(varchar(20), f1.[File_ID]) + ''" target="_blank">Image</a>''      else ''''    end as Item_Image,    case      when isnull(f2.[File_ID], 0) > 0 then ''<a href="getfile.aspx?ad=1&id='' + convert(varchar(20), f2.[File_ID]) + ''&filename=importitem_'' + convert(varchar(20), b.ID) + ''_'' + @dateNowStr + ''.pdf">MSDS Sheet</a>''      else ''''    end as MSDS_Sheet  from [SPD_Items] i     inner join [SPD_Item_Headers] ih on i.Item_Header_ID = ih.ID    inner join [SPD_Batch] b on ih.Batch_ID = b.ID    left outer join SPD_Workflow_Stage ws on b.Workflow_Stage_ID = ws.id and ws.Workflow_id = 1    LEFT OUTER JOIN [SPD_Items_Files] f1 ON f1.Item_Type = ''D'' and f1.Item_ID = i.[ID] and f1.File_Type = ''IMG''     LEFT OUTER JOIN [SPD_Items_Files] f2 ON f2.Item_Type = ''D'' and f2.Item_ID = i.[ID] and f2.File_Type = ''MSDS''   where     b.enabled = 1 and     (isnull(i.Hazardous, '''') = ''Y'') and     (@startDate is null or (@startDate is not null and b.date_modified >= @startDate)) and    (@endDate is null or (@endDate is not null and b.date_modified <= @endDate)) and     (isnull(@dept, 0) = 0 or (isnull(@dept, 0) > 0 and b.Fineline_Dept_ID = @dept)) and    ( (isnull(@stage, 0) = 0 and COALESCE(ws.Workflow_id, 1) = 1 and COALESCE(ws.Stage_Type_id, 1) <> 4 ) or (isnull(@stage, 0) > 0 and b.Workflow_Stage_ID = @stage))    and ((isnull(@vendor, 0) <= 0) or (isnull(@vendor,0) > 0 and (ih.US_Vendor_Num = @vendor or ih.Canadian_Vendor_Num = @vendor)))   '
where rtrim(report_name) = 'Domestic Item Chemical Inventory';

Update SPD_Report
set Report_SQL = 
'declare @dateNow datetime      declare @dateNowStr varchar(20)      declare @month varchar(2), @day varchar(2), @year varchar(4)          set @dateNow = getdate()      set @month = convert(varchar(2), Month(@dateNow))      if (len(@month) < 2)          set @month = ''0'' + @month          set @day = convert(varchar(2), Day(@dateNow))    if (len(@day) < 2)         set @day = ''0'' + @day      set @year = convert(varchar(4), Year(@dateNow))      if (len(@year) < 4)          set @year = ''00'' + @year          set @dateNowStr =  @year + @month + @day            select     ih.*, i.ID, i.Item_Header_ID, i.Add_Change           ,i.Pack_Item_Indicator, i.Michaels_SKU as SKU        ,i.Vendor_UPC        ,i.Class_Num        ,i.Sub_Class_Num        ,i.Vendor_Style_Num        ,i.Harmonized_Code_Number, i.Canada_Harmonized_Code_number, i.Item_Desc, i.Stocking_Strategy_Code      ,i.Eaches_Master_Case        ,i.Eaches_Inner_Pack        ,i.Pre_Priced        ,i.Pre_Priced_UDA        ,i.US_Cost        ,i.Canada_Cost        ,i.Base_Retail as Base1_Retail        ,i.Central_Retail as Base2_Retail        ,i.Test_Retail        ,i.Alaska_Retail        ,i.Canada_Retail        ,i.Zero_Nine_Retail as High2_Retail        ,i.California_Retail as High3_Retail        ,i.Village_Craft_Retail as Small_Market_Retail     ,i.Retail9 as High1_Retail        ,i.Retail10 as Base3_Retail        ,i.Retail11 as Low1_Retail        ,i.Retail12 as Low2_Retail           ,i.Retail13 as Manhattan_Retail, i.RDQuebec as Q5_Retail, i.RDPuertoRico as PR_Retail        ,i.POG_Setup_Per_Store as Initial_Set_Qty_Per_Store        ,i.POG_Max_Qty          ,i.Each_Case_Height        ,i.Each_Case_Width        ,i.Each_Case_Length        ,i.Each_Case_Weight        ,i.Each_Case_Pack_Cube        ,i.Inner_Case_Height        ,i.Inner_Case_Width        ,i.Inner_Case_Length        ,i.Inner_Case_Weight        ,i.Inner_Case_Pack_Cube        ,i.Master_Case_Height        ,i.Master_Case_Width          ,i.Master_Case_Length        ,i.Master_Case_Weight        ,i.Master_Case_Pack_Cube        ,i.Country_Of_Origin        ,i.Country_Of_Origin_Name        ,i.Tax_UDA        ,i.Tax_Value_UDA          ,i.Hazardous        ,i.Hazardous_Flammable        ,i.Hazardous_Container_Type        ,i.Hazardous_Container_Size        ,i.Hazardous_MSDS_UOM        ,i.Hazardous_Manufacturer_Name          ,i.Hazardous_Manufacturer_City        ,i.Hazardous_Manufacturer_State        ,i.Hazardous_Manufacturer_Phone        ,i.Hazardous_Manufacturer_Country        ,i.MSDS_ID          ,i.Image_ID        ,i.Tax_Wizard        ,i.Date_Created        ,i.Created_User_ID        ,i.Date_Last_Modified        ,i.Update_User_ID        ,i.Is_Valid          ,i.Like_Item_SKU        ,i.Like_Item_Description        ,i.Like_Item_Retail        ,i.Like_Item_Regular_Unit        ,i.Like_Item_Sales        ,i.Facings        ,i.POG_Min_Qty          ,i.Like_Item_Store_Count        ,i.Annual_Regular_Unit_Forecast        ,i.Annual_Reg_Retail_Sales        ,i.Like_Item_Unit_Store_Month,    b.Date_Modified as Last_Modified, COALESCE(lv.Display_Text, '''') as Private_Brand_Label  ,i.Customs_Description,   l1.Package_Language_Indicator as  Package_Language_Indicator_English,      l2.Package_Language_Indicator as  Package_Language_Indicator_French,   l3.Package_Language_Indicator as  Package_Language_Indicator_Spanish,   l1.Translation_Indicator as  Translation_Indicator_English,      l2.Translation_Indicator as  Translation_Indicator_French,   l3.Translation_Indicator as  Translation_Indicator_Spanish, l1.Description_Long as English_Long_Description, l1.Description_Short as English_Short_Description  ,l2.Description_Long as French_Long_Description, l2.Description_Short as French_Short_Description  ,l3.Description_Long as Spanish_Long_Description, l3.Description_Short as Spanish_Short_Description  ,case      when isnull(f1.[File_ID], 0) > 0 then ''<a href="getimage.aspx?id='' + convert(varchar(20), f1.[File_ID]) + ''" target="_blank">Image</a>''      else ''''    end as Item_Image      ,case      when isnull(f2.[File_ID], 0) > 0 then ''<a href="getfile.aspx?ad=1&id='' + convert(varchar(20), f2.[File_ID]) + ''&filename=importitem_'' + convert(varchar(20), b.ID) + ''_'' + @dateNowStr + ''.pdf">MSDS Sheet</a>''      else ''''    end as MSDS_Sheet      from [SPD_Items] i         inner join [SPD_Item_Headers] ih on i.Item_Header_ID = ih.ID        inner join [SPD_Batch] b on ih.Batch_ID = b.ID        left outer join SPD_Workflow_Stage ws on b.Workflow_Stage_ID = ws.id and ws.Workflow_id = 1        LEFT OUTER JOIN [SPD_Items_Files] f1 ON f1.Item_Type = ''D'' and f1.Item_ID = i.[ID] and f1.File_Type = ''IMG''         LEFT OUTER JOIN [SPD_Items_Files] f2 ON f2.Item_Type = ''D'' and f2.Item_ID = i.[ID] and f2.File_Type = ''MSDS''       LEFT OUTER JOIN SPD_Item_Languages as l1 on l1.Item_ID = i.ID And l1.Language_Type_ID = 1    LEFT OUTER JOIN SPD_Item_Languages as l2 on l2.Item_ID = i.ID And l2.Language_Type_ID = 2    LEFT OUTER JOIN SPD_Item_Languages as l3 on l3.Item_ID = i.ID And l3.Language_Type_ID = 3    LEFT OUTER JOIN List_Values as lv on lv.List_Value_Group_ID = 16 And i.Private_Brand_Label = lv.List_Value    where     b.enabled = 1 and        (@startDate is null or (@startDate is not null and b.date_modified >= @startDate)) and      (@endDate is null or (@endDate is not null and b.date_modified <= @endDate)) and   (isnull(@dept, 0) = 0 or (isnull(@dept, 0) > 0 and b.Fineline_Dept_ID = @dept)) and      ( (isnull(@stage, 0) = 0 and COALESCE(ws.Workflow_id, 1) = 1 and COALESCE(ws.Stage_Type_id, 1) <> 4 ) or (isnull(@stage, 0) > 0 and b.Workflow_Stage_ID = @stage)) and   ((isnull(@vendor, 0) <= 0) or (isnull(@vendor,0) > 0 and (ih.US_Vendor_Num = @vendor or ih.Canadian_Vendor_Num = @vendor)))  '
where rtrim(report_name) = 'Domestic Item Language';

--*****************************
--SPD_Report: Import Item Language report
--*****************************
Update SPD_Report
set Report_SQL = 
'declare @dateNow datetime      declare @dateNowStr varchar(20)      declare @month varchar(2), @day varchar(2), @year varchar(4)          set @dateNow = getdate()      set @month = convert(varchar(2), Month(@dateNow))      if (len(@month) < 2)          set @month = ''0'' + @month          set @day = convert(varchar(2), Day(@dateNow))      if (len(@day) < 2)          set @day = ''0'' + @day          set @year = convert(varchar(4), Year(@dateNow))      if (len(@year) < 4)          set @year = ''00'' + @year           set @dateNowStr =  @year + @month + @day        select     ii.ID        ,ii.Batch_ID        ,ii.DateCreated        ,ii.DateLastModified        ,ii.CreatedUserID        ,ii.UpdateUserID          ,ii.DateSubmitted        ,ii.Vendor        ,ii.Agent As MerchBurden        ,ii.AgentType As MerchBurdenType        ,ii.Buyer        ,ii.Fax        ,ii.EnteredBy        ,ii.QuoteSheetStatus          ,ii.Season        ,ii.SKUGroup        ,ii.Email        ,ii.EnteredDate        ,ii.Dept        ,ii.Class        ,ii.SubClass        ,ii.PrimaryUPC          ,ii.MichaelsSKU as SKU       ,ii.GenerateMichaelsUPC as GenerateUPC   ,ii.AdditionalUPC1        ,ii.AdditionalUPC2        ,ii.AdditionalUPC3        ,ii.AdditionalUPC4          ,ii.AdditionalUPC5        ,ii.AdditionalUPC6        ,ii.AdditionalUPC7        ,ii.AdditionalUPC8        ,ii.PackSKU        ,ii.PlanogramName          ,ii.VendorNumber        ,ii.VendorRank        ,ii.ItemTask        ,ii.Description        ,ii.PaymentTerms        ,ii.Days        ,ii.VendorMinOrderAmount          ,ii.VendorName        ,ii.VendorAddress1        ,ii.VendorAddress2        ,ii.VendorAddress3        ,ii.VendorAddress4        ,ii.VendorContactName          ,ii.VendorContactPhone        ,ii.VendorContactEmail        ,ii.VendorContactFax        ,ii.ManufactureName        ,ii.ManufactureAddress1          ,ii.ManufactureAddress2        ,ii.ManufactureContact        ,ii.ManufacturePhone        ,ii.ManufactureEmail        ,ii.ManufactureFax          ,ii.AgentContact        ,ii.AgentPhone        ,ii.AgentEmail        ,ii.AgentFax        ,ii.VendorStyleNumber        ,ii.HarmonizedCodeNumber, ii.CanadaHarmonizedCodeNumber           ,ii.DetailInvoiceCustomsDesc        ,ii.ComponentMaterialBreakdown        ,ii.ComponentConstructionMethod        ,ii.IndividualItemPackaging          ,ii.EachInsideMasterCaseBox        ,ii.EachInsideInnerPack        ,ii.eachweight as EachCartonWeight,  ii.eachlength as EachCartonLength, ii.eachwidth as EachCartonWidth, ii.eachheight as EachCartonHeight, ii.cubicfeeteach as CubicFeetPerEachCarton, ii.ReshippableInnerCartonWeight          ,ii.ReshippableInnerCartonLength          ,ii.ReshippableInnerCartonWidth        ,ii.ReshippableInnerCartonHeight        ,ii.MasterCartonDimensionsLength        ,ii.MasterCartonDimensionsWidth          ,ii.MasterCartonDimensionsHeight        ,ii.CubicFeetPerMasterCarton        ,ii.WeightMasterCarton        ,ii.CubicFeetPerInnerCarton        ,ii.FOBShippingPoint          ,ii.DutyPercent        ,ii.DutyAmount        ,ii.AdditionalDutyComment        ,ii.AdditionalDutyAmount        ,ii.OceanFreightAmount        ,ii.OceanFreightComputedAmount          ,ii.AgentCommissionPercent As MerchBurdenPercent        ,ii.AgentCommissionAmount As MerchBurdenAmount        ,ii.OtherImportCostsPercent        ,ii.OtherImportCostsAmount        ,ii.PackagingCostAmount          ,ii.TotalImportBurden        ,ii.WarehouseLandedCost        ,ii.PurchaseOrderIssuedTo        ,ii.ShippingPoint        ,ii.CountryOfOrigin          ,ii.CountryOfOriginName        ,ii.VendorComments        ,ii.StockCategory        ,ii.FreightTerms        ,ii.ItemType        ,ii.PackItemIndicator          ,ii.ItemTypeAttribute        ,ii.AllowStoreOrder        ,ii.InventoryControl        ,ii.AutoReplenish        ,ii.PrePriced        ,ii.TaxUDA          ,ii.PrePricedUDA        ,ii.TaxValueUDA        ,ii.Stocking_Strategy_Code      ,ii.StoreSuppZoneGRP          ,ii.WhseSuppZoneGRP        ,ii.POGMaxQty        ,ii.POGSetupPerStore as Initial_Set_Qty_Per_Store        ,ii.OutboundFreight        ,ii.NinePercentWhseCharge          ,ii.TotalStoreLandedCost        ,ii.RDBase as Base1_Retail        ,ii.RDCentral as Base2_Retail        ,ii.RDTest as Test_Retail        ,ii.RDAlaska as Alaska_Retail          ,ii.RDCanada as Canada_Retail        ,ii.RD0Thru9 as High2_Retail        ,ii.RDCalifornia as High3_Retail        ,ii.RDVillageCraft as Small_Market_Retail       ,ii.Retail9 as High1_Retail        ,ii.Retail10 as Base3_Retail        ,ii.Retail11 as Low1_Retail        ,ii.Retail12 as Low2_Retail          ,ii.Retail13 as Manhattan_Retail        ,ii.RDQuebec as Q5_Retail, ii.RDPuertoRico as PR_Retail ,ii.HazMatYes        ,ii.HazMatNo          ,ii.HazMatMFGCountry        ,ii.HazMatMFGName        ,ii.HazMatMFGFlammable        ,ii.HazMatMFGCity        ,ii.HazMatContainerType        ,ii.HazMatMFGState          ,ii.HazMatContainerSize        ,ii.HazMatMFGPhone        ,ii.HazMatMSDSUOM        ,ii.TSSA        ,ii.CSA        ,ii.UL        ,ii.LicenceAgreement          ,ii.FumigationCertificate        ,ii.KILNDriedCertificate        ,ii.ChinaComInspecNumAndCCIBStickers        ,ii.OriginalVisa        ,ii.TextileDeclarationMidCode          ,ii.QuotaChargeStatement        ,ii.MSDS        ,ii.TSCA        ,ii.DropBallTestCert        ,ii.ManMedicalDeviceListing        ,ii.ManFDARegistration          ,ii.CopyRightIndemnification        ,ii.FishWildLifeCert        ,ii.Proposition65LabelReq        ,ii.CCCR        ,ii.FormaldehydeCompliant        ,ii.Is_Valid          ,ii.Tax_Wizard        ,ii.RMS_Sellable        ,ii.RMS_Orderable        ,ii.RMS_Inventory        ,ii.Parent_ID        ,ii.RegularBatchItem        ,ii.Sequence          ,ii.Store_Total        ,ii.POG_Start_Date        ,ii.POG_Comp_Date        ,ii.Like_Item_SKU        ,ii.Like_Item_Description        ,ii.Like_Item_Retail          ,ii.Like_Item_Regular_Unit        ,ii.Like_Item_Sales        ,ii.Facings        ,ii.POG_Min_Qty        ,ii.Displayer_Cost        ,ii.Product_Cost        ,ii.Calculate_Options          ,ii.Like_Item_Store_Count        ,ii.Like_Item_Unit_Store_Month        ,ii.Annual_Reg_Retail_Sales        ,ii.Annual_Regular_Unit_Forecast        ,ii.Inner_Pack        ,ii.Min_Pres_Per_Facing,      COALESCE(lv.Display_Text, '''') as Private_Brand_Label  ,ii.QuoteReferenceNumber, ii.Customs_Description,   l1.Package_Language_Indicator as Package_Language_Indicator_English,   l2.Package_Language_Indicator as Package_Language_Indicator_French,   l3.Package_Language_Indicator as Package_Language_Indicator_Spanish,   l1.Translation_Indicator as Translation_Indicator_English,   l2.Translation_Indicator as Translation_Indicator_French,   l3.Translation_Indicator as Translation_Indicator_Spanish, l1.Description_Short as English_Short_Description, l1.Description_Long as English_Long_Description  ,l2.Description_Short as French_Short_Description, l2.Description_Long as French_Long_Description, l3.Description_Short as Spanish_Short_Description, l3.Description_Long as Spanish_Long_Description  ,b.Date_Modified as Last_Modified,     case      when isnull(f1.[File_ID], 0) > 0 then ''<a href="getimage.aspx?id='' + convert(varchar(20), f1.[File_ID]) + ''" target="_blank">Image</a>''      else ''''    end as Item_Image,        case      when isnull(f2.[File_ID], 0) > 0 then ''<a href="getfile.aspx?ad=1&id='' + convert(varchar(20), f2.[File_ID]) + ''&filename=importitem_'' + convert(varchar(20), b.ID) + ''_'' + @dateNowStr + ''.pdf">MSDS Sheet</a>''      else ''''    end as MSDS_Sheet      from [SPD_Import_Items] ii         inner join [SPD_Batch] b on ii.Batch_ID = b.ID        left outer join SPD_Workflow_Stage ws on b.Workflow_Stage_ID = ws.id and ws.Workflow_id = 1        LEFT OUTER JOIN [SPD_Items_Files] f1 ON f1.Item_Type = ''I'' and f1.Item_ID = ii.[ID] and f1.File_Type = ''IMG''         LEFT OUTER JOIN [SPD_Items_Files] f2 ON f2.Item_Type = ''I'' and f2.Item_ID = ii.[ID] and f2.File_Type = ''MSDS''       LEFT OUTER JOIN SPD_Import_Item_Languages as l1 on l1.Import_Item_ID = ii.ID AND l1.Language_Type_ID = 1    LEFT OUTER JOIN SPD_Import_Item_Languages as l2 on l2.Import_Item_ID = ii.ID AND l2.Language_Type_ID = 2    LEFT OUTER JOIN SPD_Import_Item_Languages as l3 on l3.Import_Item_ID = ii.ID AND l3.Language_Type_ID = 3    LEFT OUTER JOIN List_Values as lv on lv.List_Value_Group_ID = 16 And ii.Private_Brand_Label = lv.List_Value    where     b.enabled = 1 and       (@startDate is null or (@startDate is not null and b.date_modified >= @startDate)) and    (@endDate is null or (@endDate is not null and b.date_modified <= @endDate)) and       (isnull(@dept, 0) = 0 or (isnull(@dept, 0) > 0 and b.Fineline_Dept_ID = @dept)) and    ((isnull(@stage, 0) = 0 and COALESCE(ws.Workflow_id, 1) = 1 and COALESCE(ws.Stage_Type_id, 1) <> 4) or (isnull(@stage, 0) > 0 and b.Workflow_Stage_ID = @stage)) and     ((isnull(@vendor, 0) <= 0) or (isnull(@vendor,0) > 0 and b.Vendor_Number = @vendor))  '
where rtrim(report_name) = 'Import Item Language';
