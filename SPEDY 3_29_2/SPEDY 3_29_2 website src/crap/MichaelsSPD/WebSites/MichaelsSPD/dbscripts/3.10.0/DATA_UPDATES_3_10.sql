--*****************************
--SPD_Report: Import Item Chemical Inventory report
--*****************************
Update SPD_Report
set Report_SQL = 
'declare @dateNow datetime    declare @dateNowStr varchar(20)    declare @month varchar(2), @day varchar(2), @year varchar(4)        set @dateNow = getdate()    set @month = convert(varchar(2), Month(@dateNow))      if (len(@month) < 2)       set @month = ''0'' + @month      set @day = convert(varchar(2), Day(@dateNow))    if (len(@day) < 2)       set @day = ''0'' + @day      set @year = convert(varchar(4), Year(@dateNow))    if (len(@year) < 4)       set @year = ''00'' + @year      set @dateNowStr =  @year + @month + @day      select     ii.ID        ,ii.Batch_ID        ,ii.DateCreated        ,ii.DateLastModified        ,ii.CreatedUserID        ,ii.UpdateUserID        ,ii.DateSubmitted        ,ii.Vendor        ,ii.Agent As MerchBurden        ,ii.AgentType As MerchBurdenType        ,ii.Buyer        ,ii.Fax        ,ii.EnteredBy        ,ii.QuoteSheetStatus        ,ii.Season        ,ii.SKUGroup        ,ii.Email        ,ii.EnteredDate        ,ii.Dept        ,ii.Class        ,ii.SubClass        ,ii.PrimaryUPC        ,ii.MichaelsSKU as SKU        ,ii.GenerateMichaelsUPC as GenerateUPC       ,ii.AdditionalUPC1        ,ii.AdditionalUPC2        ,ii.AdditionalUPC3        ,ii.AdditionalUPC4        ,ii.AdditionalUPC5        ,ii.AdditionalUPC6        ,ii.AdditionalUPC7        ,ii.AdditionalUPC8        ,ii.PackSKU        ,ii.PlanogramName        ,ii.VendorNumber        ,ii.VendorRank        ,ii.ItemTask        ,ii.Description        ,ii.PaymentTerms        ,ii.Days        ,ii.VendorMinOrderAmount        ,ii.VendorName        ,ii.VendorAddress1        ,ii.VendorAddress2        ,ii.VendorAddress3        ,ii.VendorAddress4        ,ii.VendorContactName        ,ii.VendorContactPhone        ,ii.VendorContactEmail        ,ii.VendorContactFax        ,ii.ManufactureName        ,ii.ManufactureAddress1        ,ii.ManufactureAddress2        ,ii.ManufactureContact        ,ii.ManufacturePhone        ,ii.ManufactureEmail        ,ii.ManufactureFax        ,ii.AgentContact        ,ii.AgentPhone        ,ii.AgentEmail        ,ii.AgentFax        ,ii.VendorStyleNumber        ,ii.HarmonizedCodeNumber, ii.CanadaHarmonizedCodeNumber        ,ii.DetailInvoiceCustomsDesc        ,ii.ComponentMaterialBreakdown        ,ii.ComponentConstructionMethod        ,ii.IndividualItemPackaging        ,ii.EachInsideMasterCaseBox        ,ii.EachInsideInnerPack        ,ii.EachPieceNetWeightLbsPerOunce        ,ii.ReshippableInnerCartonLength        ,ii.ReshippableInnerCartonWidth        ,ii.ReshippableInnerCartonHeight        ,ii.MasterCartonDimensionsLength        ,ii.MasterCartonDimensionsWidth        ,ii.MasterCartonDimensionsHeight        ,ii.CubicFeetPerMasterCarton        ,ii.WeightMasterCarton        ,ii.CubicFeetPerInnerCarton        ,ii.FOBShippingPoint        ,ii.DutyPercent        ,ii.DutyAmount        ,ii.AdditionalDutyComment        ,ii.AdditionalDutyAmount        ,ii.OceanFreightAmount        ,ii.OceanFreightComputedAmount        ,ii.AgentCommissionPercent As MerchBurdenPercent        ,ii.AgentCommissionAmount As MerchBurdenAmount        ,ii.OtherImportCostsPercent        ,ii.OtherImportCostsAmount        ,ii.PackagingCostAmount        ,ii.TotalImportBurden        ,ii.WarehouseLandedCost        ,ii.PurchaseOrderIssuedTo        ,ii.ShippingPoint        ,ii.CountryOfOrigin        ,ii.CountryOfOriginName        ,ii.VendorComments        ,ii.StockCategory        ,ii.FreightTerms        ,ii.ItemType        ,ii.PackItemIndicator        ,ii.ItemTypeAttribute        ,ii.AllowStoreOrder        ,ii.InventoryControl        ,ii.AutoReplenish        ,ii.PrePriced        ,ii.TaxUDA        ,ii.PrePricedUDA        ,ii.TaxValueUDA        ,ii.Stocking_Strategy_Code       ,ii.StoreSuppZoneGRP        ,ii.WhseSuppZoneGRP        ,ii.POGMaxQty        ,ii.POGSetupPerStore as Initial_Set_Qty_Per_Store    ,ii.OutboundFreight        ,ii.NinePercentWhseCharge        ,ii.TotalStoreLandedCost        ,ii.RDBase as Base1_Retail        ,ii.RDCentral as Base2_Retail        ,ii.RDTest as Test_Retail        ,ii.RDAlaska as Alaska_Retail        ,ii.RDCanada as Canada_Retail        ,ii.RD0Thru9 as High2_Retail        ,ii.RDCalifornia as High3_Retail        ,ii.RDVillageCraft as Small_Market_Retail     ,ii.Retail9 as High1_Retail        ,ii.Retail10 as Base3_Retail        ,ii.Retail11 as Low1_Retail        ,ii.Retail12 as Low2_Retail        ,ii.Retail13 as Manhattan_Retail        ,ii.HazMatYes        ,ii.HazMatNo        ,ii.HazMatMFGCountry        ,ii.HazMatMFGName        ,ii.HazMatMFGFlammable        ,ii.HazMatMFGCity        ,ii.HazMatContainerType        ,ii.HazMatMFGState        ,ii.HazMatContainerSize        ,ii.HazMatMFGPhone        ,ii.HazMatMSDSUOM        ,ii.TSSA        ,ii.CSA        ,ii.UL        ,ii.LicenceAgreement        ,ii.FumigationCertificate        ,ii.KILNDriedCertificate        ,ii.ChinaComInspecNumAndCCIBStickers        ,ii.OriginalVisa        ,ii.TextileDeclarationMidCode        ,ii.QuotaChargeStatement        ,ii.MSDS        ,ii.TSCA        ,ii.DropBallTestCert        ,ii.ManMedicalDeviceListing        ,ii.ManFDARegistration        ,ii.CopyRightIndemnification        ,ii.FishWildLifeCert        ,ii.Proposition65LabelReq        ,ii.CCCR        ,ii.FormaldehydeCompliant        ,ii.Is_Valid        ,ii.Tax_Wizard        ,ii.RMS_Sellable        ,ii.RMS_Orderable        ,ii.RMS_Inventory        ,ii.Parent_ID        ,ii.RegularBatchItem        ,ii.Sequence        ,ii.Store_Total        ,ii.POG_Start_Date        ,ii.POG_Comp_Date        ,ii.Like_Item_SKU        ,ii.Like_Item_Description        ,ii.Like_Item_Retail        ,ii.Like_Item_Regular_Unit        ,ii.Like_Item_Sales        ,ii.Facings        ,ii.POG_Min_Qty        ,ii.Displayer_Cost        ,ii.Product_Cost        ,ii.Calculate_Options        ,ii.Like_Item_Store_Count        ,ii.Like_Item_Unit_Store_Month        ,ii.Annual_Reg_Retail_Sales        ,ii.Annual_Regular_Unit_Forecast        ,ii.Inner_Pack        ,ii.Min_Pres_Per_Facing,    b.Date_Modified as Last_Modified,      case      when isnull(f1.[File_ID], 0) > 0 then ''<a href="getimage.aspx?id='' + convert(varchar(20), f1.[File_ID]) + ''" target="_blank">Image</a>''      else ''''    end as Item_Image,      case      when isnull(f2.[File_ID], 0) > 0 then ''<a href="getfile.aspx?ad=1&id='' + convert(varchar(20), f2.[File_ID]) + ''&filename=importitem_'' + convert(varchar(20), b.ID) + ''_'' + @dateNowStr + ''.pdf">MSDS Sheet</a>''      else ''''    end as MSDS_Sheet    from [SPD_Import_Items] ii       inner join [SPD_Batch] b on ii.Batch_ID = b.ID      left outer join SPD_Workflow_Stage ws on b.Workflow_Stage_ID = ws.id and ws.Workflow_id = 1      LEFT OUTER JOIN [SPD_Items_Files] f1 ON f1.Item_Type = ''I'' and f1.Item_ID = ii.[ID] and f1.File_Type = ''IMG''       LEFT OUTER JOIN [SPD_Items_Files] f2 ON f2.Item_Type = ''I'' and f2.Item_ID = ii.[ID] and f2.File_Type = ''MSDS''     where     b.enabled = 1 and       (isnull(ii.HazMatYes, '''') != '''') and       (@startDate is null or (@startDate is not null and b.date_modified >= @startDate)) and    (@endDate is null or (@endDate is not null and b.date_modified <= @endDate)) and       (isnull(@dept, 0) = 0 or (isnull(@dept, 0) > 0 and b.Fineline_Dept_ID = @dept)) and    ( (isnull(@stage, 0) = 0 and COALESCE(ws.Workflow_id, 1) = 1 and COALESCE(ws.Stage_Type_id, 1) <> 4 ) or (isnull(@stage, 0) > 0 and b.Workflow_Stage_ID = @stage)) and    ((isnull(@vendor, 0) <= 0) or (isnull(@vendor,0) > 0 and b.Vendor_Number = @vendor))  '
where rtrim(report_name) = 'Import Item Chemical Inventory';


--*****************************
--SPD_Report: Domestic Item Chemical Inventory report
--*****************************
Update SPD_Report
set Report_SQL = 
'declare @dateNow datetime  declare @dateNowStr varchar(20)  declare @month varchar(2), @day varchar(2), @year varchar(4)  set @dateNow = getdate()  set @month = convert(varchar(2), Month(@dateNow))  if (len(@month) < 2)    set @month = ''0'' + @month  set @day = convert(varchar(2), Day(@dateNow))  if (len(@day) < 2)    set @day = ''0'' + @day  set @year = convert(varchar(4), Year(@dateNow))  if (len(@year) < 4)    set @year = ''00'' + @year  set @dateNowStr =  @year + @month + @day    select     ih.*,    i.ID        ,i.Item_Header_ID        ,i.Add_Change        ,i.Pack_Item_Indicator        ,i.Michaels_SKU as SKU        ,i.Vendor_UPC        ,i.Class_Num        ,i.Sub_Class_Num        ,i.Vendor_Style_Num        ,i.Item_Desc        ,i.Stocking_Strategy_Code       ,i.Eaches_Master_Case        ,i.Eaches_Inner_Pack        ,i.Pre_Priced        ,i.Pre_Priced_UDA        ,i.US_Cost        ,i.Canada_Cost        ,i.Base_Retail as Base1_Retail        ,i.Central_Retail as Base2_Retail        ,i.Test_Retail        ,i.Alaska_Retail        ,i.Canada_Retail        ,i.Zero_Nine_Retail as High2_Retail        ,i.California_Retail as High3_Retail        ,i.Village_Craft_Retail as Small_Market_Retail     ,i.Retail9 as High1_Retail        ,i.Retail10 as Base3_Retail        ,i.Retail11 as Low1_Retail        ,i.Retail12 as Low2_Retail        ,i.Retail13 as Manhattan_Retail        ,i.POG_Setup_Per_Store as Initial_Set_Qty_Per_Store        ,i.POG_Max_Qty        ,i.Inner_Case_Height        ,i.Inner_Case_Width        ,i.Inner_Case_Length        ,i.Inner_Case_Weight        ,i.Inner_Case_Pack_Cube        ,i.Master_Case_Height        ,i.Master_Case_Width        ,i.Master_Case_Length        ,i.Master_Case_Weight        ,i.Master_Case_Pack_Cube        ,i.Country_Of_Origin        ,i.Country_Of_Origin_Name        ,i.Tax_UDA        ,i.Tax_Value_UDA        ,i.Hazardous        ,i.Hazardous_Flammable        ,i.Hazardous_Container_Type        ,i.Hazardous_Container_Size        ,i.Hazardous_MSDS_UOM        ,i.Hazardous_Manufacturer_Name        ,i.Hazardous_Manufacturer_City        ,i.Hazardous_Manufacturer_State        ,i.Hazardous_Manufacturer_Phone        ,i.Hazardous_Manufacturer_Country        ,i.MSDS_ID        ,i.Image_ID        ,i.Tax_Wizard        ,i.Date_Created        ,i.Created_User_ID        ,i.Date_Last_Modified        ,i.Update_User_ID        ,i.Is_Valid        ,i.Like_Item_SKU        ,i.Like_Item_Description        ,i.Like_Item_Retail        ,i.Like_Item_Regular_Unit        ,i.Like_Item_Sales        ,i.Facings        ,i.POG_Min_Qty        ,i.Like_Item_Store_Count        ,i.Annual_Regular_Unit_Forecast        ,i.Annual_Reg_Retail_Sales        ,i.Like_Item_Unit_Store_Month,    b.Date_Modified as Last_Modified,    case      when isnull(f1.[File_ID], 0) > 0 then ''<a href="getimage.aspx?id='' + convert(varchar(20), f1.[File_ID]) + ''" target="_blank">Image</a>''      else ''''    end as Item_Image,    case      when isnull(f2.[File_ID], 0) > 0 then ''<a href="getfile.aspx?ad=1&id='' + convert(varchar(20), f2.[File_ID]) + ''&filename=importitem_'' + convert(varchar(20), b.ID) + ''_'' + @dateNowStr + ''.pdf">MSDS Sheet</a>''      else ''''    end as MSDS_Sheet  from [SPD_Items] i     inner join [SPD_Item_Headers] ih on i.Item_Header_ID = ih.ID    inner join [SPD_Batch] b on ih.Batch_ID = b.ID    left outer join SPD_Workflow_Stage ws on b.Workflow_Stage_ID = ws.id and ws.Workflow_id = 1    LEFT OUTER JOIN [SPD_Items_Files] f1 ON f1.Item_Type = ''D'' and f1.Item_ID = i.[ID] and f1.File_Type = ''IMG''     LEFT OUTER JOIN [SPD_Items_Files] f2 ON f2.Item_Type = ''D'' and f2.Item_ID = i.[ID] and f2.File_Type = ''MSDS''   where     b.enabled = 1 and     (isnull(i.Hazardous, '''') = ''Y'') and     (@startDate is null or (@startDate is not null and b.date_modified >= @startDate)) and    (@endDate is null or (@endDate is not null and b.date_modified <= @endDate)) and     (isnull(@dept, 0) = 0 or (isnull(@dept, 0) > 0 and b.Fineline_Dept_ID = @dept)) and    ( (isnull(@stage, 0) = 0 and COALESCE(ws.Workflow_id, 1) = 1 and COALESCE(ws.Stage_Type_id, 1) <> 4 ) or (isnull(@stage, 0) > 0 and b.Workflow_Stage_ID = @stage))    and ((isnull(@vendor, 0) <= 0) or (isnull(@vendor,0) > 0 and (ih.US_Vendor_Num = @vendor or ih.Canadian_Vendor_Num = @vendor)))   '
where rtrim(report_name) = 'Domestic Item Chemical Inventory';

--*****************************
--SPD_Report: Domestic Item Language report
--*****************************
Update SPD_Report
set Report_SQL = 
'declare @dateNow datetime      declare @dateNowStr varchar(20)      declare @month varchar(2), @day varchar(2), @year varchar(4)          set @dateNow = getdate()      set @month = convert(varchar(2), Month(@dateNow))      if (len(@month) < 2)          set @month = ''0'' + @month          set @day = convert(varchar(2), Day(@dateNow))    if (len(@day) < 2)         set @day = ''0'' + @day      set @year = convert(varchar(4), Year(@dateNow))      if (len(@year) < 4)          set @year = ''00'' + @year          set @dateNowStr =  @year + @month + @day            select     ih.*, i.ID, i.Item_Header_ID, i.Add_Change           ,i.Pack_Item_Indicator, i.Michaels_SKU as SKU        ,i.Vendor_UPC        ,i.Class_Num        ,i.Sub_Class_Num        ,i.Vendor_Style_Num        ,i.Item_Desc, i.Stocking_Strategy_Code      ,i.Eaches_Master_Case        ,i.Eaches_Inner_Pack        ,i.Pre_Priced        ,i.Pre_Priced_UDA        ,i.US_Cost        ,i.Canada_Cost        ,i.Base_Retail as Base1_Retail        ,i.Central_Retail as Base2_Retail        ,i.Test_Retail        ,i.Alaska_Retail        ,i.Canada_Retail        ,i.Zero_Nine_Retail as High2_Retail        ,i.California_Retail as High3_Retail        ,i.Village_Craft_Retail as Small_Market_Retail     ,i.Retail9 as High1_Retail        ,i.Retail10 as Base3_Retail        ,i.Retail11 as Low1_Retail        ,i.Retail12 as Low2_Retail           ,i.Retail13 as Manhattan_Retail, i.RDQuebec as Q5_Retail, i.RDPuertoRico as PR_Retail        ,i.POG_Setup_Per_Store as Initial_Set_Qty_Per_Store        ,i.POG_Max_Qty          ,i.Inner_Case_Height        ,i.Inner_Case_Width        ,i.Inner_Case_Length        ,i.Inner_Case_Weight        ,i.Inner_Case_Pack_Cube        ,i.Master_Case_Height        ,i.Master_Case_Width          ,i.Master_Case_Length        ,i.Master_Case_Weight        ,i.Master_Case_Pack_Cube        ,i.Country_Of_Origin        ,i.Country_Of_Origin_Name        ,i.Tax_UDA        ,i.Tax_Value_UDA          ,i.Hazardous        ,i.Hazardous_Flammable        ,i.Hazardous_Container_Type        ,i.Hazardous_Container_Size        ,i.Hazardous_MSDS_UOM        ,i.Hazardous_Manufacturer_Name          ,i.Hazardous_Manufacturer_City        ,i.Hazardous_Manufacturer_State        ,i.Hazardous_Manufacturer_Phone        ,i.Hazardous_Manufacturer_Country        ,i.MSDS_ID          ,i.Image_ID        ,i.Tax_Wizard        ,i.Date_Created        ,i.Created_User_ID        ,i.Date_Last_Modified        ,i.Update_User_ID        ,i.Is_Valid          ,i.Like_Item_SKU        ,i.Like_Item_Description        ,i.Like_Item_Retail        ,i.Like_Item_Regular_Unit        ,i.Like_Item_Sales        ,i.Facings        ,i.POG_Min_Qty          ,i.Like_Item_Store_Count        ,i.Annual_Regular_Unit_Forecast        ,i.Annual_Reg_Retail_Sales        ,i.Like_Item_Unit_Store_Month,    b.Date_Modified as Last_Modified, COALESCE(lv.Display_Text, '''') as Private_Brand_Label  ,i.Customs_Description,   l1.Package_Language_Indicator as  Package_Language_Indicator_English,      l2.Package_Language_Indicator as  Package_Language_Indicator_French,   l3.Package_Language_Indicator as  Package_Language_Indicator_Spanish,   l1.Translation_Indicator as  Translation_Indicator_English,      l2.Translation_Indicator as  Translation_Indicator_French,   l3.Translation_Indicator as  Translation_Indicator_Spanish, l1.Description_Long as English_Long_Description, l1.Description_Short as English_Short_Description  ,l2.Description_Long as French_Long_Description, l2.Description_Short as French_Short_Description  ,l3.Description_Long as Spanish_Long_Description, l3.Description_Short as Spanish_Short_Description  ,case      when isnull(f1.[File_ID], 0) > 0 then ''<a href="getimage.aspx?id='' + convert(varchar(20), f1.[File_ID]) + ''" target="_blank">Image</a>''      else ''''    end as Item_Image      ,case      when isnull(f2.[File_ID], 0) > 0 then ''<a href="getfile.aspx?ad=1&id='' + convert(varchar(20), f2.[File_ID]) + ''&filename=importitem_'' + convert(varchar(20), b.ID) + ''_'' + @dateNowStr + ''.pdf">MSDS Sheet</a>''      else ''''    end as MSDS_Sheet      from [SPD_Items] i         inner join [SPD_Item_Headers] ih on i.Item_Header_ID = ih.ID        inner join [SPD_Batch] b on ih.Batch_ID = b.ID        left outer join SPD_Workflow_Stage ws on b.Workflow_Stage_ID = ws.id and ws.Workflow_id = 1        LEFT OUTER JOIN [SPD_Items_Files] f1 ON f1.Item_Type = ''D'' and f1.Item_ID = i.[ID] and f1.File_Type = ''IMG''         LEFT OUTER JOIN [SPD_Items_Files] f2 ON f2.Item_Type = ''D'' and f2.Item_ID = i.[ID] and f2.File_Type = ''MSDS''       LEFT OUTER JOIN SPD_Item_Languages as l1 on l1.Item_ID = i.ID And l1.Language_Type_ID = 1    LEFT OUTER JOIN SPD_Item_Languages as l2 on l2.Item_ID = i.ID And l2.Language_Type_ID = 2    LEFT OUTER JOIN SPD_Item_Languages as l3 on l3.Item_ID = i.ID And l3.Language_Type_ID = 3    LEFT OUTER JOIN List_Values as lv on lv.List_Value_Group_ID = 16 And i.Private_Brand_Label = lv.List_Value    where     b.enabled = 1 and        (@startDate is null or (@startDate is not null and b.date_modified >= @startDate)) and      (@endDate is null or (@endDate is not null and b.date_modified <= @endDate)) and   (isnull(@dept, 0) = 0 or (isnull(@dept, 0) > 0 and b.Fineline_Dept_ID = @dept)) and      ( (isnull(@stage, 0) = 0 and COALESCE(ws.Workflow_id, 1) = 1 and COALESCE(ws.Stage_Type_id, 1) <> 4 ) or (isnull(@stage, 0) > 0 and b.Workflow_Stage_ID = @stage)) and   ((isnull(@vendor, 0) <= 0) or (isnull(@vendor,0) > 0 and (ih.US_Vendor_Num = @vendor or ih.Canadian_Vendor_Num = @vendor)))  '
where rtrim(report_name) = 'Domestic Item Language';

--*****************************
--SPD_Report: Import Item Language report
--*****************************
Update SPD_Report
set Report_SQL = 
'declare @dateNow datetime      declare @dateNowStr varchar(20)      declare @month varchar(2), @day varchar(2), @year varchar(4)          set @dateNow = getdate()      set @month = convert(varchar(2), Month(@dateNow))      if (len(@month) < 2)          set @month = ''0'' + @month          set @day = convert(varchar(2), Day(@dateNow))      if (len(@day) < 2)          set @day = ''0'' + @day          set @year = convert(varchar(4), Year(@dateNow))      if (len(@year) < 4)          set @year = ''00'' + @year           set @dateNowStr =  @year + @month + @day        select     ii.ID        ,ii.Batch_ID        ,ii.DateCreated        ,ii.DateLastModified        ,ii.CreatedUserID        ,ii.UpdateUserID          ,ii.DateSubmitted        ,ii.Vendor        ,ii.Agent As MerchBurden        ,ii.AgentType As MerchBurdenType        ,ii.Buyer        ,ii.Fax        ,ii.EnteredBy        ,ii.QuoteSheetStatus          ,ii.Season        ,ii.SKUGroup        ,ii.Email        ,ii.EnteredDate        ,ii.Dept        ,ii.Class        ,ii.SubClass        ,ii.PrimaryUPC          ,ii.MichaelsSKU as SKU       ,ii.GenerateMichaelsUPC as GenerateUPC   ,ii.AdditionalUPC1        ,ii.AdditionalUPC2        ,ii.AdditionalUPC3        ,ii.AdditionalUPC4          ,ii.AdditionalUPC5        ,ii.AdditionalUPC6        ,ii.AdditionalUPC7        ,ii.AdditionalUPC8        ,ii.PackSKU        ,ii.PlanogramName          ,ii.VendorNumber        ,ii.VendorRank        ,ii.ItemTask        ,ii.Description        ,ii.PaymentTerms        ,ii.Days        ,ii.VendorMinOrderAmount          ,ii.VendorName        ,ii.VendorAddress1        ,ii.VendorAddress2        ,ii.VendorAddress3        ,ii.VendorAddress4        ,ii.VendorContactName          ,ii.VendorContactPhone        ,ii.VendorContactEmail        ,ii.VendorContactFax        ,ii.ManufactureName        ,ii.ManufactureAddress1          ,ii.ManufactureAddress2        ,ii.ManufactureContact        ,ii.ManufacturePhone        ,ii.ManufactureEmail        ,ii.ManufactureFax          ,ii.AgentContact        ,ii.AgentPhone        ,ii.AgentEmail        ,ii.AgentFax        ,ii.VendorStyleNumber        ,ii.HarmonizedCodeNumber, ii.CanadaHarmonizedCodeNumber           ,ii.DetailInvoiceCustomsDesc        ,ii.ComponentMaterialBreakdown        ,ii.ComponentConstructionMethod        ,ii.IndividualItemPackaging          ,ii.EachInsideMasterCaseBox        ,ii.EachInsideInnerPack        ,ii.EachPieceNetWeightLbsPerOunce        ,ii.ReshippableInnerCartonLength          ,ii.ReshippableInnerCartonWidth        ,ii.ReshippableInnerCartonHeight        ,ii.MasterCartonDimensionsLength        ,ii.MasterCartonDimensionsWidth          ,ii.MasterCartonDimensionsHeight        ,ii.CubicFeetPerMasterCarton        ,ii.WeightMasterCarton        ,ii.CubicFeetPerInnerCarton        ,ii.FOBShippingPoint          ,ii.DutyPercent        ,ii.DutyAmount        ,ii.AdditionalDutyComment        ,ii.AdditionalDutyAmount        ,ii.OceanFreightAmount        ,ii.OceanFreightComputedAmount          ,ii.AgentCommissionPercent As MerchBurdenPercent        ,ii.AgentCommissionAmount As MerchBurdenAmount        ,ii.OtherImportCostsPercent        ,ii.OtherImportCostsAmount        ,ii.PackagingCostAmount          ,ii.TotalImportBurden        ,ii.WarehouseLandedCost        ,ii.PurchaseOrderIssuedTo        ,ii.ShippingPoint        ,ii.CountryOfOrigin          ,ii.CountryOfOriginName        ,ii.VendorComments        ,ii.StockCategory        ,ii.FreightTerms        ,ii.ItemType        ,ii.PackItemIndicator          ,ii.ItemTypeAttribute        ,ii.AllowStoreOrder        ,ii.InventoryControl        ,ii.AutoReplenish        ,ii.PrePriced        ,ii.TaxUDA          ,ii.PrePricedUDA        ,ii.TaxValueUDA        ,ii.Stocking_Strategy_Code      ,ii.StoreSuppZoneGRP          ,ii.WhseSuppZoneGRP        ,ii.POGMaxQty        ,ii.POGSetupPerStore as Initial_Set_Qty_Per_Store        ,ii.OutboundFreight        ,ii.NinePercentWhseCharge          ,ii.TotalStoreLandedCost        ,ii.RDBase as Base1_Retail        ,ii.RDCentral as Base2_Retail        ,ii.RDTest as Test_Retail        ,ii.RDAlaska as Alaska_Retail          ,ii.RDCanada as Canada_Retail        ,ii.RD0Thru9 as High2_Retail        ,ii.RDCalifornia as High3_Retail        ,ii.RDVillageCraft as Small_Market_Retail       ,ii.Retail9 as High1_Retail        ,ii.Retail10 as Base3_Retail        ,ii.Retail11 as Low1_Retail        ,ii.Retail12 as Low2_Retail          ,ii.Retail13 as Manhattan_Retail        ,ii.RDQuebec as Q5_Retail, ii.RDPuertoRico as PR_Retail ,ii.HazMatYes        ,ii.HazMatNo          ,ii.HazMatMFGCountry        ,ii.HazMatMFGName        ,ii.HazMatMFGFlammable        ,ii.HazMatMFGCity        ,ii.HazMatContainerType        ,ii.HazMatMFGState          ,ii.HazMatContainerSize        ,ii.HazMatMFGPhone        ,ii.HazMatMSDSUOM        ,ii.TSSA        ,ii.CSA        ,ii.UL        ,ii.LicenceAgreement          ,ii.FumigationCertificate        ,ii.KILNDriedCertificate        ,ii.ChinaComInspecNumAndCCIBStickers        ,ii.OriginalVisa        ,ii.TextileDeclarationMidCode          ,ii.QuotaChargeStatement        ,ii.MSDS        ,ii.TSCA        ,ii.DropBallTestCert        ,ii.ManMedicalDeviceListing        ,ii.ManFDARegistration          ,ii.CopyRightIndemnification        ,ii.FishWildLifeCert        ,ii.Proposition65LabelReq        ,ii.CCCR        ,ii.FormaldehydeCompliant        ,ii.Is_Valid          ,ii.Tax_Wizard        ,ii.RMS_Sellable        ,ii.RMS_Orderable        ,ii.RMS_Inventory        ,ii.Parent_ID        ,ii.RegularBatchItem        ,ii.Sequence          ,ii.Store_Total        ,ii.POG_Start_Date        ,ii.POG_Comp_Date        ,ii.Like_Item_SKU        ,ii.Like_Item_Description        ,ii.Like_Item_Retail          ,ii.Like_Item_Regular_Unit        ,ii.Like_Item_Sales        ,ii.Facings        ,ii.POG_Min_Qty        ,ii.Displayer_Cost        ,ii.Product_Cost        ,ii.Calculate_Options          ,ii.Like_Item_Store_Count        ,ii.Like_Item_Unit_Store_Month        ,ii.Annual_Reg_Retail_Sales        ,ii.Annual_Regular_Unit_Forecast        ,ii.Inner_Pack        ,ii.Min_Pres_Per_Facing,      COALESCE(lv.Display_Text, '''') as Private_Brand_Label  ,ii.QuoteReferenceNumber, ii.Customs_Description,   l1.Package_Language_Indicator as Package_Language_Indicator_English,   l2.Package_Language_Indicator as Package_Language_Indicator_French,   l3.Package_Language_Indicator as Package_Language_Indicator_Spanish,   l1.Translation_Indicator as Translation_Indicator_English,   l2.Translation_Indicator as Translation_Indicator_French,   l3.Translation_Indicator as Translation_Indicator_Spanish, l1.Description_Short as English_Short_Description, l1.Description_Long as English_Long_Description  ,l2.Description_Short as French_Short_Description, l2.Description_Long as French_Long_Description, l3.Description_Short as Spanish_Short_Description, l3.Description_Long as Spanish_Long_Description  ,b.Date_Modified as Last_Modified,     case      when isnull(f1.[File_ID], 0) > 0 then ''<a href="getimage.aspx?id='' + convert(varchar(20), f1.[File_ID]) + ''" target="_blank">Image</a>''      else ''''    end as Item_Image,        case      when isnull(f2.[File_ID], 0) > 0 then ''<a href="getfile.aspx?ad=1&id='' + convert(varchar(20), f2.[File_ID]) + ''&filename=importitem_'' + convert(varchar(20), b.ID) + ''_'' + @dateNowStr + ''.pdf">MSDS Sheet</a>''      else ''''    end as MSDS_Sheet      from [SPD_Import_Items] ii         inner join [SPD_Batch] b on ii.Batch_ID = b.ID        left outer join SPD_Workflow_Stage ws on b.Workflow_Stage_ID = ws.id and ws.Workflow_id = 1        LEFT OUTER JOIN [SPD_Items_Files] f1 ON f1.Item_Type = ''I'' and f1.Item_ID = ii.[ID] and f1.File_Type = ''IMG''         LEFT OUTER JOIN [SPD_Items_Files] f2 ON f2.Item_Type = ''I'' and f2.Item_ID = ii.[ID] and f2.File_Type = ''MSDS''       LEFT OUTER JOIN SPD_Import_Item_Languages as l1 on l1.Import_Item_ID = ii.ID AND l1.Language_Type_ID = 1    LEFT OUTER JOIN SPD_Import_Item_Languages as l2 on l2.Import_Item_ID = ii.ID AND l2.Language_Type_ID = 2    LEFT OUTER JOIN SPD_Import_Item_Languages as l3 on l3.Import_Item_ID = ii.ID AND l3.Language_Type_ID = 3    LEFT OUTER JOIN List_Values as lv on lv.List_Value_Group_ID = 16 And ii.Private_Brand_Label = lv.List_Value    where     b.enabled = 1 and       (@startDate is null or (@startDate is not null and b.date_modified >= @startDate)) and    (@endDate is null or (@endDate is not null and b.date_modified <= @endDate)) and       (isnull(@dept, 0) = 0 or (isnull(@dept, 0) > 0 and b.Fineline_Dept_ID = @dept)) and    ((isnull(@stage, 0) = 0 and COALESCE(ws.Workflow_id, 1) = 1 and COALESCE(ws.Stage_Type_id, 1) <> 4) or (isnull(@stage, 0) > 0 and b.Workflow_Stage_ID = @stage)) and     ((isnull(@vendor, 0) <= 0) or (isnull(@vendor,0) > 0 and b.Vendor_Number = @vendor))  '
where rtrim(report_name) = 'Import Item Language';